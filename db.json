{"meta":{"version":1,"warehouse":"4.0.2"},"models":{"Asset":[{"_id":"themes/archer/source/assets/algolia_logo.svg","path":"assets/algolia_logo.svg","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/beian.png","path":"assets/beian.png","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/example_qr.png","path":"assets/example_qr.png","modified":0,"renderable":1},{"_id":"themes/archer/source/avatar/Misaka.jpg","path":"avatar/Misaka.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/favicon.ico","path":"assets/favicon.ico","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/loading.svg","path":"assets/loading.svg","modified":0,"renderable":1},{"_id":"themes/archer/source/css/dark.css","path":"css/dark.css","modified":0,"renderable":1},{"_id":"themes/archer/source/css/dark.css.map","path":"css/dark.css.map","modified":0,"renderable":1},{"_id":"themes/archer/source/css/mobile.css","path":"css/mobile.css","modified":0,"renderable":1},{"_id":"themes/archer/source/css/mobile.css.map","path":"css/mobile.css.map","modified":0,"renderable":1},{"_id":"themes/archer/source/css/style.css","path":"css/style.css","modified":0,"renderable":1},{"_id":"themes/archer/source/css/style.css.map","path":"css/style.css.map","modified":0,"renderable":1},{"_id":"themes/archer/source/font/Oswald-Regular.ttf","path":"font/Oswald-Regular.ttf","modified":0,"renderable":1},{"_id":"themes/archer/source/font/Source Sans Pro.woff","path":"font/Source Sans Pro.woff","modified":0,"renderable":1},{"_id":"themes/archer/source/font/Source Sans Pro.woff2","path":"font/Source Sans Pro.woff2","modified":0,"renderable":1},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff","path":"font/SourceCodePro-Regular.ttf.woff","modified":0,"renderable":1},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff2","path":"font/SourceCodePro-Regular.ttf.woff2","modified":0,"renderable":1},{"_id":"themes/archer/source/intro/404-bg.jpg","path":"intro/404-bg.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/intro/about-bg.jpg","path":"intro/about-bg.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/lib/jquery.min.js","path":"lib/jquery.min.js","modified":0,"renderable":1},{"_id":"themes/archer/source/intro/index-bg.jpg","path":"intro/index-bg.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/intro/post-bg.jpg","path":"intro/post-bg.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/lib/webfontloader.min.js","path":"lib/webfontloader.min.js","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/customFontLoader.js","path":"scripts/customFontLoader.js","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/customFontLoader.js.map","path":"scripts/customFontLoader.js.map","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/dark.js.map","path":"scripts/dark.js.map","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/dark.js","path":"scripts/dark.js","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/main.js","path":"scripts/main.js","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/main.js.LICENSE.txt","path":"scripts/main.js.LICENSE.txt","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/main.js.map","path":"scripts/main.js.map","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/search.js","path":"scripts/search.js","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/search.js.LICENSE.txt","path":"scripts/search.js.LICENSE.txt","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/search.js.map","path":"scripts/search.js.map","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/share.js","path":"scripts/share.js","modified":0,"renderable":1},{"_id":"themes/archer/source/scripts/share.js.map","path":"scripts/share.js.map","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/favicon_1.jpg","path":"assets/favicon_1.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/wechat_qr.png","path":"assets/wechat_qr.png","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/qq_qr.png","path":"assets/qq_qr.png","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/qq_qr.jpg","path":"assets/qq_qr.jpg","modified":0,"renderable":1},{"_id":"themes/archer/source/assets/favicon_1.png","path":"assets/favicon_1.png","modified":0,"renderable":1}],"Cache":[{"_id":"source/_posts/hello-world.md","hash":"acad91ace80b80295b11a9b7ad4c29a2dcfdd8fb","modified":1681970230735},{"_id":"themes/archer/layout/_partial/comment/custom.ejs","hash":"da39a3ee5e6b4b0d3255bfef95601890afd80709","modified":1639818257000},{"_id":"themes/archer/.babelrc","hash":"078678843ebb6992f0cc44304faa6f1cb082bd4a","modified":1639818257000},{"_id":"themes/archer/.editorconfig","hash":"3a7f38d9586f73ed1c46cfbc9839b3465ec57d7c","modified":1639818257000},{"_id":"themes/archer/.gitattributes","hash":"82c1a621642d5b620275ae1ed59845c3f7015a64","modified":1639818257000},{"_id":"themes/archer/.eslintrc.json","hash":"352a07b94efa124a5658b502bf973683be09fd00","modified":1639818257000},{"_id":"themes/archer/.prettierrc.js","hash":"bae1d8dab7bf8b68207386f366e092778940540c","modified":1639818257000},{"_id":"themes/archer/CHANGELOG.md","hash":"6fbf3e5e8ed6ae6fb68fd74bfd2b53d99db4b1fd","modified":1639818257000},{"_id":"themes/archer/.prettierignore","hash":"41abb32fef2d4686421aff0f29b796fef29dcc18","modified":1639818257000},{"_id":"themes/archer/.gitignore","hash":"b5de96e5158df11ad8c49d149f45ec014e18971a","modified":1639818257000},{"_id":"themes/archer/LICENSE","hash":"0da0c361bf299375739c6b668a44af0f5faf37bb","modified":1639818257000},{"_id":"themes/archer/README.md","hash":"069ea3c82bb762e76420b1fa1515eb93fc545574","modified":1639818257000},{"_id":"themes/archer/package.json","hash":"8fe7d738be6f9b73a624ea1236a12881b900c555","modified":1639818257000},{"_id":"themes/archer/_config.yml","hash":"9f521c49bdeebab3c3a1f180ee01be6d65557e57","modified":1682061503172},{"_id":"themes/archer/webpack.prod.js","hash":"a34abc06d6cd8fa4e267069468726322a3656e2b","modified":1639818257000},{"_id":"themes/archer/webpack.dev.js","hash":"7c740341894bd584f72145512a58703bb134ea60","modified":1639818257000},{"_id":"themes/archer/webpack.config.js","hash":"e090744d8e7a0d0906d1d6b8192eb906092d1e9b","modified":1639818257000},{"_id":"themes/archer/gulpfile.js","hash":"ee1ad57aa5113a084091fd86fca2c34e1b9e4b95","modified":1639818257000},{"_id":"themes/archer/docs/README-en.md","hash":"f325565c0bb94501fd046268659c7752709895d1","modified":1639818257000},{"_id":"themes/archer/languages/default.yml","hash":"e937791c5080868c3abe20bab4cf266a342b5922","modified":1639818257000},{"_id":"themes/archer/docs/develop-guide-en.md","hash":"0bb09c3c9d5f56820cb84e3316f60352b731d70c","modified":1639818257000},{"_id":"themes/archer/dev/archer.sh","hash":"4065c4e55462d5ecf016464adea0d1db967ef4b4","modified":1639818257000},{"_id":"themes/archer/docs/develop-guide-zh.md","hash":"db6a9945e6040bd63d006da7b0b7e7ba5febd150","modified":1639818257000},{"_id":"themes/archer/languages/en.yml","hash":"5a1a85fed95dab4f01671714ee8cc5420936c05f","modified":1639818257000},{"_id":"themes/archer/layout/about.ejs","hash":"748786bebad03b1ef79c551f26522fa2bee1b9dd","modified":1639818257000},{"_id":"themes/archer/layout/404.ejs","hash":"9137c0b1153ca8cd32e60a38fd79b7e4b91c8bf4","modified":1639818257000},{"_id":"themes/archer/layout/index.ejs","hash":"093f8dbe875cad94b9618f181d1b5621d8874b19","modified":1639818257000},{"_id":"themes/archer/layout/layout.ejs","hash":"1bee90a75c1f4b04c90421419dd68acdec15b998","modified":1639818257000},{"_id":"themes/archer/layout/site-meta.ejs","hash":"562e446a742fde07e0880343d5693bf8cb0dec23","modified":1639818257000},{"_id":"themes/archer/layout/post.ejs","hash":"d421aba0ab93e2b7a22d060da4c56441bf97cdb9","modified":1639818257000},{"_id":"themes/archer/.github/ISSUE_TEMPLATE/-----------bug--help-wanted-or-bug-report-.md","hash":"012bd3afea5565204f75d8c89048ad33b9c2f948","modified":1639818257000},{"_id":"themes/archer/.github/workflows/deploy-demo-page.yml","hash":"91c065ee0ec29f7bb10263fefa6f3072bc493a38","modified":1639818257000},{"_id":"themes/archer/.github/ISSUE_TEMPLATE/-----other-issue-.md","hash":"4bf3c8ebef14a81bb55e8e0468d816e83c4133ac","modified":1639818257000},{"_id":"themes/archer/.github/ISSUE_TEMPLATE/-----feature-request-.md","hash":"886fb1252702d46c89536b579d35ce49e53ec54d","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-background-image.ejs","hash":"4e6091b81f7f327cffee6275174c52918cd1789a","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-footer-fixed.ejs","hash":"e4dbde6594c0c2d1c5de71ddf968be0879ceddb7","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-footer.ejs","hash":"d8f4236166d058421c2e4ff00660be75a3494704","modified":1639818257000},{"_id":"themes/archer/layout/_partial/algolia.ejs","hash":"c7bf50dd6e60fd8e8dfbeab9960172359af7307e","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-head.ejs","hash":"76fd2b40c501d5c6eb764c336f11521e045febc9","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-header.ejs","hash":"57d1ae0fd6f9f1ab52a64c44a8ae17ee71de22ef","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-social.ejs","hash":"0190f06c2f0345cec00eba2074bbfd1b56a7fdc9","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-profile.ejs","hash":"b4be51c4c02b69d3e95a555ae00047f3b6c2926f","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-preload-polyfill.ejs","hash":"d046322674052b0667775dca0886f14e0d812897","modified":1639818257000},{"_id":"themes/archer/layout/_partial/base-title-tags.ejs","hash":"1d5a95782ffc382fdb6b1239b3b97db125984fa0","modified":1639818257000},{"_id":"themes/archer/layout/_partial/custom-font.ejs","hash":"bc6bfda53f8856e1473263a44fd861e96cc00719","modified":1639818257000},{"_id":"themes/archer/source/assets/algolia_logo.svg","hash":"90035272fa31a3f65b3c0e2cb8a633876ef457dc","modified":1639818257000},{"_id":"themes/archer/layout/_partial/intro-height.ejs","hash":"7b8b078b1c1e5b216e46b32a0cab67330c92c734","modified":1639818257000},{"_id":"themes/archer/source/avatar/Misaka.jpg","hash":"74a0372523f98dfbba992bf80642e160d04dc9b1","modified":1639818257000},{"_id":"themes/archer/source/assets/beian.png","hash":"a99df13e8eb11db86edebf6e5ac246eb59f4b3c4","modified":1639818257000},{"_id":"themes/archer/source/assets/example_qr.png","hash":"cce20432c34875f4d9c6df927ede0fc0f00bb194","modified":1639818257000},{"_id":"themes/archer/source/assets/loading.svg","hash":"45be17d07697d604d8981890eb21e308530c7a38","modified":1639818257000},{"_id":"themes/archer/source/assets/favicon.ico","hash":"8b200c575d273d41a179c102442e191414e74eae","modified":1639818257000},{"_id":"themes/archer/source/css/dark.css","hash":"32b2072ca8d39803cbd8f7395dcf02f6390dbee3","modified":1639818257000},{"_id":"themes/archer/source/css/dark.css.map","hash":"f5b60d05584b47dea744edff92c44bc389675e05","modified":1639818257000},{"_id":"themes/archer/source/css/mobile.css","hash":"7b73350f80ee39ec30b4c61895d274b4889329f4","modified":1639818257000},{"_id":"themes/archer/source/css/mobile.css.map","hash":"1f26e4000a416870ccf4e85083f7209dc55f4482","modified":1639818257000},{"_id":"themes/archer/source/css/style.css","hash":"2a3733ec29221a6f9a74f08b821ca079d18dbea6","modified":1639818257000},{"_id":"themes/archer/source/font/Source Sans Pro.woff","hash":"a6722c9b6439b7a020a9be3d3178970757a9265c","modified":1639818257000},{"_id":"themes/archer/source/font/Source Sans Pro.woff2","hash":"da65f527a8da65d5eb6721626d28cfdb46ab104a","modified":1639818257000},{"_id":"themes/archer/source/lib/webfontloader.min.js","hash":"4c69aeb4e4f355912503d1c460e8e7aa6ea6963e","modified":1639818257000},{"_id":"themes/archer/source/scripts/customFontLoader.js","hash":"e95e00bdb80b5b2abef477eabe59005cc8d196c5","modified":1639818257000},{"_id":"themes/archer/source/scripts/dark.js.map","hash":"512d8ca5ed89950d8fad95ba1200f0b21ba82388","modified":1639818257000},{"_id":"themes/archer/source/scripts/dark.js","hash":"b0b3b400432f1913c57c817e3d8ad40dbfeebabc","modified":1639818257000},{"_id":"themes/archer/source/scripts/main.js.LICENSE.txt","hash":"7f3206da6b550feb5291feee14bc02e74d3076a1","modified":1639818257000},{"_id":"themes/archer/source/scripts/search.js.LICENSE.txt","hash":"f98b4df48bbadc7ab1e8f9fc4618b86d33bdf44f","modified":1639818257000},{"_id":"themes/archer/src/js/browser.js","hash":"c56e0094a04d6f20564f8f0da1496cb7631d4dc2","modified":1639818257000},{"_id":"themes/archer/src/js/customFontLoader.js","hash":"98bb3a1c0f69bc2675bfa6579df2dde38ba6fded","modified":1639818257000},{"_id":"themes/archer/src/js/dark.js","hash":"2cd243df8593b18a1a293f483d2db18503c53547","modified":1639818257000},{"_id":"themes/archer/src/js/fancybox.js","hash":"6dfc8015d6000c76806424876f5472f39e5485af","modified":1639818257000},{"_id":"themes/archer/source/scripts/share.js","hash":"f47267d78d896ae1ec2b4daba9f7ed098712a95b","modified":1639818257000},{"_id":"themes/archer/src/js/fontawsome.js","hash":"43e852899ee1bc22495253428a2ff3bdedf89882","modified":1639818257000},{"_id":"themes/archer/src/js/init.js","hash":"dee0a1c959bd4dc3953428b1b2137f42bc659b32","modified":1639818257000},{"_id":"themes/archer/src/js/initSidebar.js","hash":"c9c030a451ed394934c1858c7d55ec5a7b588305","modified":1639818257000},{"_id":"themes/archer/src/js/mobile.js","hash":"4ae6837e18b729f85b5097867fc742ba2d1edf25","modified":1639818257000},{"_id":"themes/archer/src/js/main.js","hash":"103af0f91a07e77cb20ac3f8b547a043586d34ea","modified":1639818257000},{"_id":"themes/archer/src/js/scroll.js","hash":"19f1e5352228034f897f503a25bd760c3bebcbf2","modified":1639818257000},{"_id":"themes/archer/src/js/share.js","hash":"c2e6a3d8d6883cde0c67484daca5e742ebb8e0d1","modified":1639818257000},{"_id":"themes/archer/src/js/search.js","hash":"0bf92b51fef092989f4fe16fb7ef7724d11e9f58","modified":1639818257000},{"_id":"themes/archer/src/js/sidebar.js","hash":"3f917f2fb5c5b9db1660458899506547b1767746","modified":1639818257000},{"_id":"themes/archer/src/js/tag.js","hash":"395db7eb2d09e2df6eefcf3f4c7da5cd809a6221","modified":1639818257000},{"_id":"themes/archer/src/js/util.js","hash":"e49b30f6ba82d5183d005fc0192d2d673969586b","modified":1639818257000},{"_id":"themes/archer/src/js/toc.js","hash":"ff7022cd08e26baf22cbf8c1f158e5fd67e74e48","modified":1639818257000},{"_id":"themes/archer/src/scss/_common.scss","hash":"e80acb4f0049d24260f0a32a301f985ae7e166b8","modified":1639818257000},{"_id":"themes/archer/src/scss/_normalize.scss","hash":"a2dbeb38ad08bb8975856d75954cc697bf8e5ff7","modified":1639818257000},{"_id":"themes/archer/src/scss/_mixin.scss","hash":"78da2632e7150baa0fd1f6d04fc59ca5e304903d","modified":1639818257000},{"_id":"themes/archer/src/scss/dark.scss","hash":"739af46f0ef8c0c89c3e78ec577e844678f737b5","modified":1639818257000},{"_id":"themes/archer/src/scss/_variables.scss","hash":"01e5cab2b5fc686c52145d65229f17db13a3cc54","modified":1639818257000},{"_id":"themes/archer/src/scss/mobile.scss","hash":"20bb8ac78c3a2505f5b8997f31544ff23179aaf7","modified":1639818257000},{"_id":"themes/archer/src/scss/style.scss","hash":"b10b9a44efaa293b7ac220e66c963dca04ad4bc7","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/changyan.ejs","hash":"cc02b3cf9586135d2d7f822c7ad97d81fdf6d4e5","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/gitalk.ejs","hash":"840279fd3e21dc1cdb1932fe4d9a3be5f670e764","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/gitment.ejs","hash":"eda79ada5171ed44e4f3ae4d8a345ad2c7adb2df","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/disqus.ejs","hash":"0f0612ce9ca5c3dc349153a87fdc9dba5f93c52c","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/livere.ejs","hash":"d65d9372fca4b316b94ae511f8ccfb0b92d7b065","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/valine.ejs","hash":"24cd7b9e28ceb4b2083ddccce26517de64b35119","modified":1639818257000},{"_id":"themes/archer/layout/_partial/critical-css/critical-style.ejs","hash":"e67a7a2f6bcbfd97e95577446872e217e0c48e80","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/waline.ejs","hash":"c2208d6f05490bbf1b35cdf1519a39933212c33e","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/utteranc.ejs","hash":"f4ec58c74e6870b8c22032ad3a3c1ee33e5ec41d","modified":1639818257000},{"_id":"themes/archer/layout/_partial/math/mathjax.ejs","hash":"84c40a07765e95213045e9b9f7a8c9aaa9c69161","modified":1639818257000},{"_id":"themes/archer/layout/_partial/comment/youyan.ejs","hash":"2f4ef49a74a8d63310af60ecda6d765b8c386ff4","modified":1639818257000},{"_id":"themes/archer/layout/_partial/script/font-loader.ejs","hash":"0473335774025d185dcbaf641496b25a8f33f7af","modified":1639818257000},{"_id":"themes/archer/layout/_partial/sidebar/sidebar-archives.ejs","hash":"6360da867c23b8daa5e34e62c5c5552e2974e360","modified":1639818257000},{"_id":"themes/archer/layout/_partial/sidebar/base-sidebar.ejs","hash":"bdf08beebbe454da9d4c55b35efd317d5f222be5","modified":1639818257000},{"_id":"themes/archer/layout/_partial/sidebar/sidebar-tags.ejs","hash":"469455994771da166ddecb4839efa9ef28f2775d","modified":1639818257000},{"_id":"themes/archer/layout/_partial/sidebar/sidebar-categories.ejs","hash":"02f407d9f9968d228a6a47f2a283b8cf41836a1a","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_404.scss","hash":"9e5cb20871e5bf1af4cf50694a73bd7c9fe64685","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_common-dark.scss","hash":"fc03470312c57a39bc131a1e86cdd3ea2ddb164a","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_algolia-dark.scss","hash":"e9ea52ca5410c6a6eb53d2a6de1419d3db97d8ca","modified":1639818257000},{"_id":"themes/archer/src/scss/_mobile/_partial/_index-page-mobile.scss","hash":"2d166bb6f234b8773a9ea12457b10e94902a32f1","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_algolia.scss","hash":"fd7716d8559a9f58f7caef576c553ca7ba1a85e1","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_index-page.scss","hash":"7ed45c11316bb9bf441ab897fcfed9beea108ad6","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_post-page-dark.scss","hash":"d61059785c72c626990f5b473dc3570cb52c0d73","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_post-page.scss","hash":"26a55109cd29fd0f01134aaf5cb80bde789f4d13","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_comment/_gitalk.scss","hash":"341bb251987f30221936e36b44374b2b5ce0d218","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_footer-fixed.scss","hash":"1eb918f6c16054ef2b53b9eea60c751ad89bbd55","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_index-page-dark.scss","hash":"4c1406e82b2d4503e027443f64f0984fe0942e1d","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_footer.scss","hash":"4aafefa6834c8a8583c1cdace620a31306676a57","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_intro.scss","hash":"4567b9081f063e5fb388b0671f3bc322bdc9acfa","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_header.scss","hash":"3ae33e6dec6956dee8e9f524e2947ad3cc717b37","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_paginator.scss","hash":"67c2e697a5fbb3b8006cf358ea45eb7f75b496f8","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_post/_code.scss","hash":"504f9fdb723c7b287d958211189d25919ac592f6","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_profile.scss","hash":"4771add895f8a47917ae2d0d34b92cb327329bf1","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_post/_writing-enhance.scss","hash":"4cb495c64d144b2bcf225f2b87641017bd652e66","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_sidebar/_sidebar-archive.scss","hash":"a7374f46ca31bf8ebf5bafea909100921d0c52a4","modified":1639818257000},{"_id":"themes/archer/src/scss/_mobile/_partial/_post/_writing-enhance-mobile.scss","hash":"9e714c1cdc61a4ebd5510667e87e879d0b14de67","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_partial/_scrollbar.scss","hash":"424c08f4acc3f643567f138ffea7d8337791d2c4","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_sidebar/_sidebar-tags.scss","hash":"93cc82cb56663e83e90fbd6fe31ffdd38e694f3b","modified":1639818257000},{"_id":"themes/archer/src/scss/_partial/_sidebar/_sidebar.scss","hash":"b2870a9cdaea9b9c8426d406d6859a8f3f1a995f","modified":1639818257000},{"_id":"themes/archer/src/scss/_mobile/_partial/_sidebar/_sidebar-tags-mobile.scss","hash":"b5c62234defe693b4cfa65bda188d71c937eeaf9","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_footer-dark.scss","hash":"d074a8fef75ba626dd3448cc42290a8c722fd182","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_footer-fixed-dark.scss","hash":"f4e3eb7aa19c1061b5d9df4f6a7745902e5843f2","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_comment/_gitalk-dark.scss","hash":"f5d5c83166450e2346d0a2182c8726f8c98cfb1a","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_post/_code-dark.scss","hash":"9ded8203699f816558fd1493a3ce7cf3d38818e9","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_sidebar/_sidebar-archive-dark.scss","hash":"79b7548214339807ff713f0c7454a227d24d6d0d","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_sidebar/_sidebar-dark.scss","hash":"8e77738f83a425eebb00513ee98e487fe71fdc22","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_sidebar/_sidebar-tags-dark.scss","hash":"6621db2ff1182e3cd14286af4b8f3d8c5bd14e2a","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_profile-dark.scss","hash":"c0fe68f6e9c196157adc71fea0d97f6f70f0a31b","modified":1639818257000},{"_id":"themes/archer/src/scss/_dark/_partial/_partial/_header-dark.scss","hash":"ed815d959a37cccdf9137ace91c68bea8ca922c2","modified":1639818257000},{"_id":"themes/archer/source/font/Oswald-Regular.ttf","hash":"965d729546a43a8490ad4cf33c25ac475682100c","modified":1639818257000},{"_id":"themes/archer/source/css/style.css.map","hash":"c9495e0d815109b6cb17ddaa1a99e10714e0a6e8","modified":1639818257000},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff","hash":"12eef75e1ad3eca9dae42b65505010ce4464a315","modified":1639818257000},{"_id":"themes/archer/source/font/SourceCodePro-Regular.ttf.woff2","hash":"f5991289ec17884cb641da0646d278d36702a190","modified":1639818257000},{"_id":"themes/archer/source/intro/404-bg.jpg","hash":"3afb5bb26f4ff0bd0e0a28df955c8aa7d746d3c5","modified":1639818257000},{"_id":"themes/archer/source/lib/jquery.min.js","hash":"ad886e472b3557f3dc7dfa2bc43468ab8d1cef5b","modified":1639818257000},{"_id":"themes/archer/source/scripts/customFontLoader.js.map","hash":"0fb40aed5a9c1d3f97dbad07ae3279229eaebea9","modified":1639818257000},{"_id":"themes/archer/source/scripts/share.js.map","hash":"b6a3e931cf44fdac5fd717f64019f2aa3b0d62ef","modified":1639818257000},{"_id":"themes/archer/source/intro/about-bg.jpg","hash":"ab388276822417cc4e703312c14e20280ec783b3","modified":1639818257000},{"_id":"themes/archer/source/intro/post-bg.jpg","hash":"525fafb2238c27754d8fa751f143ff1de9b8482d","modified":1639818257000},{"_id":"themes/archer/source/scripts/search.js","hash":"6f2e0cefb575617be37bfb2c2954f48e568e8f00","modified":1639818257000},{"_id":"themes/archer/package-lock.json","hash":"b0768219adb4e1abc5fa057ec2dcc5451f924ddb","modified":1639818257000},{"_id":"themes/archer/docs/snap.png","hash":"0b2a8bf016f6eed576abfdcdb7dcf8de51c12562","modified":1639818257000},{"_id":"themes/archer/source/intro/index-bg.jpg","hash":"96b52e177b8bc53e64ec6ee1e10b2b6a4e13083b","modified":1639818257000},{"_id":"themes/archer/source/scripts/search.js.map","hash":"1ecdd768a261ebede8b51ca383c9bf519a4f6c7c","modified":1639818257000},{"_id":"themes/archer/source/scripts/main.js","hash":"95f0284e68221e5f2f50e8a59de6f7fdda66608b","modified":1639818257000},{"_id":"themes/archer/source/scripts/main.js.map","hash":"b2f3bab368e872ecc910e48fff47797432ab019f","modified":1639818257000},{"_id":"source/_posts/text.md","hash":"6a91a3e54d0c81fb8b3c114040b7c7037aa93f86","modified":1681974453741},{"_id":"source/_posts/fire.md","hash":"bad7cae993e6d675f5eb57a9faa655f8dfa1da4b","modified":1681992511147},{"_id":"themes/archer/source/assets/favicon_1.jpg","hash":"2774d2eede37d4ba809c7a26e5e4390d834b14fe","modified":1681706971663},{"_id":"themes/archer/source/assets/qq_qr.png","hash":"5f34b187f7f1e5860927b05687c031d349f9d0cf","modified":1681989979811},{"_id":"themes/archer/source/assets/qq_qr.jpg","hash":"6457ff610277bc631c974e5accd7a01f350da7e6","modified":1681990193945},{"_id":"themes/archer/source/assets/favicon_1.png","hash":"7c2f110d8d065f0cebfccfe28396eb9101fc5eeb","modified":1681990617538},{"_id":"themes/archer/source/assets/wechat_qr.png","hash":"a2aea7f8fbd47b886745e31f565aa53214e53cdd","modified":1681989981316},{"_id":"source/about/index.md","hash":"50c514d42113cdfeb4bb1377802eb1ff81613b9d","modified":1681995387998},{"_id":"source/_posts/top-text.md","hash":"23af3f075f62072c065ffe971101c1944b1aec83","modified":1681996021928},{"_id":"source/_posts/hello.md","hash":"ae769727f562e1c6cc214b87c89765312aa44254","modified":1684233467954}],"Category":[{"name":"haha","_id":"clgphtz8c0000zwvtbpihbnwz"}],"Data":[],"Page":[{"title":"About","layout":"about","date":"2023-04-20T12:35:32.000Z","_content":"\n## 个人介绍\n\n某个不知名编程菜鸡. . .\n\n爱好：敲代码，摄影\n\n## 网站介绍\n本网站为 the_A_W 个人博客，目的是输出自己所学到的知识，分享一些经验，同时搭建博客也是一种锻炼\n\n，这只是一个非常简单的博客，希望在后面的学习中，能够多多完善并坚持下去，同为以后搭建个人的摄影\n\n博客积累经验，博客很多内容可能不是非常完善，也可能有一些错误，希望大佬能帮忙发现错误，指正错误！\n\n---\n<center>知识共享 友善交流</center>","source":"about/index.md","raw":"---\ntitle: About\nlayout: about\ndate: 2023-04-20 20:35:32\n---\n\n## 个人介绍\n\n某个不知名编程菜鸡. . .\n\n爱好：敲代码，摄影\n\n## 网站介绍\n本网站为 the_A_W 个人博客，目的是输出自己所学到的知识，分享一些经验，同时搭建博客也是一种锻炼\n\n，这只是一个非常简单的博客，希望在后面的学习中，能够多多完善并坚持下去，同为以后搭建个人的摄影\n\n博客积累经验，博客很多内容可能不是非常完善，也可能有一些错误，希望大佬能帮忙发现错误，指正错误！\n\n---\n<center>知识共享 友善交流</center>","updated":"2023-04-20T12:56:27.998Z","path":"about/index.html","_id":"clgp4dvsk00004cvtbmpvgw5p","comments":1,"content":"<h2 id=\"个人介绍\"><a href=\"#个人介绍\" class=\"headerlink\" title=\"个人介绍\"></a>个人介绍</h2><p>某个不知名编程菜鸡. . .</p>\n<p>爱好：敲代码，摄影</p>\n<h2 id=\"网站介绍\"><a href=\"#网站介绍\" class=\"headerlink\" title=\"网站介绍\"></a>网站介绍</h2><p>本网站为 the_A_W 个人博客，目的是输出自己所学到的知识，分享一些经验，同时搭建博客也是一种锻炼</p>\n<p>，这只是一个非常简单的博客，希望在后面的学习中，能够多多完善并坚持下去，同为以后搭建个人的摄影</p>\n<p>博客积累经验，博客很多内容可能不是非常完善，也可能有一些错误，希望大佬能帮忙发现错误，指正错误！</p>\n<hr>\n<center>知识共享 友善交流</center>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"个人介绍\"><a href=\"#个人介绍\" class=\"headerlink\" title=\"个人介绍\"></a>个人介绍</h2><p>某个不知名编程菜鸡. . .</p>\n<p>爱好：敲代码，摄影</p>\n<h2 id=\"网站介绍\"><a href=\"#网站介绍\" class=\"headerlink\" title=\"网站介绍\"></a>网站介绍</h2><p>本网站为 the_A_W 个人博客，目的是输出自己所学到的知识，分享一些经验，同时搭建博客也是一种锻炼</p>\n<p>，这只是一个非常简单的博客，希望在后面的学习中，能够多多完善并坚持下去，同为以后搭建个人的摄影</p>\n<p>博客积累经验，博客很多内容可能不是非常完善，也可能有一些错误，希望大佬能帮忙发现错误，指正错误！</p>\n<hr>\n<center>知识共享 友善交流</center>"}],"Post":[{"title":"坦克大战（IKUN版）","date":"2023-04-20T14:19:13.000Z","_content":"# C 语言坦克大战（IKUN 版）\n\n**前言：该坦克大战基于 90 经典坦克大战，对地图音乐等元素进行重新定制，实现成分十足的 IKUN 版坦克大战**\n\n**设计思路：把地图和坦克在地图上的位置都存储在一个二维数组里，坦克的移动，地图的破环以及碰撞检测都是通过修改或是检查二维数组的数据实现，以下是设计的过程**\n\n## 游戏窗口的实现\n\n通过 easyx 库中所提供的函数实现\n\n### 初始化一个 650* 650（单位：像素）大小的窗口\n\n```C++\n//初始化窗口\n\tinitgraph(650, 650);\n```\n\n### 菜单功能\n\n#### 菜单显示\n\n```C++\n//显示主菜单\nIMAGE display_1_img;\nloadimage(&display_1_img, _T(\"display_1.png\"), 650, 650);\nputimage(0, 0, &display_1_img);\n//help菜单图片\nIMAGE help_img;//help菜单图片\nloadimage(&help_img, _T(\"help.bmp\"), 650, 650);//加载图片\n```\n\n主菜单我采用了直接制作一张完整的图片然后覆盖整个窗口\n\n可以采用 easyx 中自带的绘制图形或输出文字的函数，如果要改变菜单按钮等可以直接修改代码完成，如果用整图的话就需要重新制图。\n\n主菜单的帮助界面我采用直接显示一张完整的图，所以先提前加载一下图片\n\n#### 菜单按钮实现\n\n```C++\nMOUSEMSG mouse; //储存鼠标信息变量\n```\n首先定义一个变量存储鼠标信息，通过获取到的鼠标信息在进行选择操作\n\n```C++\n//int finish = 1;//用于结束主菜单循环\n\n//主菜单按钮功能实现\nwhile (1) \n{\n\tmouse = GetMouseMsg();\n\n\tswitch (mouse.uMsg)\n\t{\n\t//help功能显示\n\tcase WM_MOUSEMOVE:\n\t\tif (mouse.x > 245 && mouse.x <430 && mouse.y>320 && mouse.y < 385)\n\t\t\tputimage(0, 0, &help_img);\n\t\telse\n\t\t\tputimage(0, 0, &display_1_img);\n\t\tbreak;\n\tcase WM_LBUTTONDOWN:\n\t\tif (mouse.x > 245 && mouse.x < 430 && mouse.y>155 && mouse.y < 225)\n\t\t{\n\t\t\tsetbkcolor(BLACK);//设置背景色\n\t\t\tcleardevice();\n\t\t\tint stage = 1;\n\t\t\twhile (1)\n\t\t\t{\n\t\t\t\tint result = game(stage);\n\t\t\t\tgameover(result);\n\t\t\t\twhile (1)\n\t\t\t\t{\n\t\t\t\t\tsystem(\"pause\");\n\t\t\t\t\tif (KEY_DOWN(Key_ENTER))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (result)\n\t\t\t\t\tstage++;\n\t\t\t}\n\t\t\t\n\t\t\tfinish = 0;\n\t\t\tbreak;\n\t\t}\n\t\telse if (mouse.x > 245 && mouse.x < 430 && mouse.y>235 && mouse.y < 300)\n\t\t{\n\t\t\tgame();\n\t\t\tbreak;\n\t\t}\n\t\telse if (mouse.x > 245 && mouse.x < 430 && mouse.y>400 && mouse.y < 470)\n\t\t{\n\t\t\texit(0);\n\t\t\tbreak;\n\t\t}\n\t}\n```\n\n这里先说明一下第一个 case 语句，**WM_MOUSEMOVE** 获取的是鼠标的移动信息，在鼠标移动的时候就进入该 case 语句，然后后面的 if 语句则进行判断，如果鼠标移动的区域在 help 框的范围那么就显示 help 图片，如果没有的话就显示主菜单的图片\n\n然后再说明一下第二个 case 语句， **WM_LBUTTONDOWN** 可以获取鼠标的左键点击信息，如果按下左键则进入该语句，同样也是通过 if 语句判断鼠标点击的位置执行不同的操作，首先说最后一个，当我们点击 exit 框的时候就直接执行 exit（0）终止程序\n\n然后说明一下第一个 if 语句，当我们点击 **new game** 时则直接进行游戏\n\n如果点击 **continue** 则会加载游戏存档，继续上一次的游戏，继续游戏和新游戏公用一个函数，通过传递不同的参数值，来选择进入 **game()** 的时候是直接初始化，还是使用存档中的内容进行初始化操作\n\n## 游戏模块\n\n#### 地图的加载以及显示\n\n```C++\n//首先在game（）函数实现的中定义一个全局二维数组以存储地图信息\nint map[map_row][map_col];//map_row,map_col为地图的长和宽，也是地图数组行和列的大小（在gamesettings.h中定义）\n\n//然后是地图资源的加载，需要从文件中加载地图资源并存储到map数组中\nvoid loadmap(int stage)\n{\n\t//地图文件流\n\tifstream map_file;\n\t//保存地图文件名\n\twstring temp;\n\ttemp = map_file_path;\n\ttemp += map_file_name;\n\tint text = 0;\n\tmap_file.open(temp);\n\tif (!map_file.is_open())\n\t{\n\t\ttext = 1;\n\t\tcout << \"打开地图失败！\" << endl;\n\t\t//exit(1);\n\t}\n\n\t//调整文件读取位置，到最大关卡数之后则从第一关开始\n\tstage -= 1;\n\tstage = stage % max_stage;\n\tmap_file.seekg(stage * map_row * map_col * 2);\n\tint num_temp;\n\tfor (int row = 0;row < map_row;row++)\n\t\tfor (int col = 0;col < map_col;col++)\n\t\t{\n\t\t\tmap_file >> dec >> num_temp;\n\t\t\tmap[row][col] = num_temp;\n\t\t}\n\tmap_file.close();\n\n}\n\n//地图显示函数\nvoid Map(int stage) {\n\tint row, col;\n\tIMAGE img_home, img_wall_1, img_wall_2;\n\n\tloadimage(&img_home, _T(\"home_1.jpg\"), 50, 50);// 老鹰\n\tloadimage(&img_wall_1, _T(\"wall_1.jpg\"), 25, 25);//不可消除的墙\n\tloadimage(&img_wall_2, _T(\"wall_2.jpg\"), 25, 25);//可消除的墙\n\n\n\tfor (i = 0; i < 26; i++) {\n\t\tfor (j = 0; j < 26; j++) {\n\t\t\tif (map[i][j] == 1) {\n\t\t\t\tputimage(25 * j, 25 * i, &img_wall_1);\n\t\t\t}\n\t\t\telse if (map[i][j] == 2) {\n\t\t\t\tputimage(25 * j, 25 * i, &img_wall_2);\n\t\t\t}\n\t\t\telse if (map[i][j] == 3) {\n\t\t\t\tputimage(25 * j, 25 * i, &img_home);\n\n\t\t\t\tmap[i][j] = 4;\n\t\t\t\tmap[i][j + 1] = 4;\n\t\t\t\tmap[i + 1][j] = 4;\n\t\t\t\tmap[i + 1][j + 1] = 4;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\ngame ()函数\n\n```C++\nint game(int stage)\n{\n\tsetbkcolor(BLACK);//设置背景色\n\tcleardevice();\n\t//背景音乐\n\tmciSendString(_T(\"play cxk_1.mp3 repeat\"), NULL, 0, NULL);\n\t//初始化随机数种子\n\tsrand((unsigned int)time(NULL));\n\t\n\n\t//我方坦克\n\tTank my_tank;\n\t//我方坦克发射的子弹\n\tBullet my_bullet;\n\n\t//敌方坦克\n\tTank enemy_tank[enemy_num];\n\t//敌方坦克发射的子弹\n\tBullet enemy_bullet[enemy_num];\n\n\n\t//加载地图\n\tloadmap(stage);\n\tMap(stage);\n\n\t//记录当前的程序的休眠次数，每次10ms\n\tint times = 0;\n\t//敌方坦克存在数量\n\tint enemy_total = 0;\n\t//子弹目前不存在\n\tmy_bullet.status = 0;\n\t\n\t//测试\n\t\n\n\t//加载坦克图片\n\tIMAGE img_mytank[DIRECTIONCOUNT];\n\tIMAGE img_enemytank[DIRECTIONCOUNT];\n\tloadimage(&img_mytank[UP], mytank_filename[UP], 50, 50);\n\tloadimage(&img_mytank[DOWN], mytank_filename[DOWN], 50, 50);\n\tloadimage(&img_mytank[LEFT],mytank_filename[LEFT], 50, 50);\n\tloadimage(&img_mytank[RIGHT], mytank_filename[RIGHT], 50, 50);\n\tloadimage(&img_enemytank[UP], enemytank_filename[UP], 50, 50);\n\tloadimage(&img_enemytank[DOWN], enemytank_filename[DOWN], 50, 50);\n\tloadimage(&img_enemytank[LEFT], enemytank_filename[LEFT], 50, 50);\n\tloadimage(&img_enemytank[RIGHT], enemytank_filename[RIGHT], 50, 50);\n\t\t\n\t//初始化坦克\n\tmy_tank.x = 8;\n\tmy_tank.y = 24;\n\tmy_tank.direction = UP;\n\tmy_tank.live = 1;\n\n\tset_map(my_tank.x, my_tank.y, 200);\n\n\t//设置敌方坦克出场位置\n\tfor (int i = 0;i < enemy_num;i++)\n\t{\n\t\tif (i % 3 == 0)\n\t\t{\n\t\t\tenemy_tank[i].x = 0;\n\t\t}\n\t\telse if (i % 3 == 1)\n\t\t{\n\t\t\tenemy_tank[i].x = 12;\n\t\t}\n\t\telse if (i % 3 == 2)\n\t\t{\n\t\t\tenemy_tank[i].x = 24;\n\t\t}\n\t\tenemy_tank[i].y = 0;\n\t\tenemy_tank[i].live = 1;\n\t\tenemy_tank[i].direction = DOWN;\n\t\tenemy_tank[i].Is_Mycamp = 0;\n\t\t//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\t\tenemy_bullet[i].status = 0;\n\t}\n\nenemy_total = 3;\n\t//enemy_tank[0].x = 4;\n\t//enemy_tank[0].y = 0;\n\t//enemy_tank[0].live = 0;\n\t//敌方坦克登场\n\tfor (int i = 0;i < enemy_total;i++)\n\t{\n\t\tif (enemy_tank[i].live)\n\t\t{\n\t\t\tset_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\t\t\tdo_tank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction], 0);\n\t\t}\n\n\t}\n\n\t//显示坦克\t\t\n\tputimage(my_tank.x * 25, my_tank.y * 25, &img_mytank[my_tank.direction]);\n\t\n\t\n\twhile (1)\n\t{\n\t\t//防止坦克出生重叠\n\t\tif (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == 0)\n\t\t{\n\t\t\tif (times > 0 && times % 1000 == 0 && enemy_total < enemy_num)\n\t\t\t{\n\t\t\t\tset_map(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, 100 + enemy_total);\n\t\t\t\tenemy_total++;\n\t\t\t}\n\t\t}\n\t\tif (times>0 && times % 200 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (!enemy_tank[i].live)\n\t\t\t\t\tcontinue;\n\t\t\t\t//攻击我方老巢\n\t\t\t\tif (i % 2 == 0)\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], 12, 24);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], my_tank.x, my_tank.y);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\ttank_fire(&enemy_tank[i], &enemy_bullet[i]);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t//0.5s移动一次敌方坦克\n\t\telse if (times % 50 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (enemy_tank[i].live)\n\t\t\t\t{\n\t\t\t\t\ttank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (times % 10 == 0)\n\t\t{\n\t\t\tif (KEY_DOWN(Key_LEFT))\n\t\t\t{\n\t\t\t\ttank_walk(&my_tank, LEFT, &img_mytank[LEFT]);\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_UP))\n\t\t\t{\n\t\t\t\tif (my_tank.direction == UP && my_tank.y - 1 >= 0 && map[my_tank.y - 1][my_tank.x] == 0 && map[my_tank.y - 1][my_tank.x + 1] == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdo_tank_walk(&my_tank, UP, &img_mytank[my_tank.direction], 1);\n\t\t\t\t\t}\n\t\t\t\t\telse if (my_tank.direction != UP)\n\t\t\t\t\t{\n\t\t\t\t\t\tmy_tank.direction = UP;\n\t\t\t\t\t\tdo_tank_walk(&my_tank, UP, &img_mytank[my_tank.direction], 0);\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_DOWN))\n\t\t\t{\n\t\t\t\tif (my_tank.direction == DOWN && my_tank.y + 2 <= 25 && map[my_tank.y + 2][my_tank.x] == 0 && map[my_tank.y + 2][my_tank.x + 1] == 0)\n\t\t\t\t{\n\t\t\t\t\tdo_tank_walk(&my_tank, DOWN, &img_mytank[my_tank.direction], 1);\n\t\t\t\t}\n\t\t\t\telse if (my_tank.direction != DOWN)\n\t\t\t\t{\n\t\t\t\t\tmy_tank.direction = DOWN;\n\t\t\t\t\tdo_tank_walk(&my_tank, DOWN, &img_mytank[my_tank.direction], 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_RIGHT))\n\t\t\t{\n\t\t\t\tif (my_tank.direction == RIGHT && my_tank.x + 2 <= 25 && map[my_tank.y][my_tank.x + 2] == 0 && map[my_tank.y + 1][my_tank.x + 2] == 0)\n\t\t\t\t{\n\t\t\t\t\tdo_tank_walk(&my_tank, RIGHT, &img_mytank[my_tank.direction], 1);\n\t\t\t\t}\n\t\t\t\telse if (my_tank.direction != RIGHT)\n\t\t\t\t{\n\t\t\t\t\tmy_tank.direction = RIGHT;\n\t\t\t\t\tdo_tank_walk(&my_tank, RIGHT, &img_mytank[my_tank.direction], 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//开火\n\t\t\tif (KEY_DOWN(Key_J_Bullut))\n\t\t\t{\n\n\t\t\t\tPlaySound(_T(\"paoji.wav\"), NULL, SND_FILENAME | SND_ASYNC);\n\t\t\t\ttank_fire(&my_tank, &my_bullet);\n\t\t\t}\n\t\t\t//暂停\n\t\t\tif (KEY_DOWN(Key_P_Stop))\n\t\t\t{\n\t\t\t\twhile (1)\n\t\t\t\t{\n\t\t\t\t\tsystem(\"pause\");\n\t\t\t\t\tif (KEY_DOWN(Key_P_Stop))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_ESC))\n\t\t\t{\n\t\t\t\t\n\t\t\t\tif (1)\n\t\t\t\t{\n\t\t\t\t\tsave(enemy_tank, &my_tank, enemy_total, times,map);\n\t\t\t\t}\n\t\t\t\tdisplay_1();\n\t\t\t\t//break;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tif (my_bullet.status)\n\t\t{\n\t\t\tif (bullet_action(&my_bullet, enemy_tank, my_tank.Is_Mycamp))\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0;i < enemy_num;i++)\n\t\t{\n\t\t\tif (enemy_bullet[i].status)\n\t\t\t{\n\t\t\t\tif (bullet_action(&enemy_bullet[i], enemy_tank,0))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//判断敌方坦克是否全部消灭\n\t\tint isWin = 0;\n\t\tfor (int i = 0;i < enemy_num;i++)\n\t\t{\n\t\t\tif (enemy_tank[i].live == 0)\n\t\t\t\tisWin++;\n\t\t\tif (isWin == 10)\n\t\t\t\treturn 1;\n\t\t}\n\t\tSleep(10);\n\t\ttimes++;\n\t}\n}\n```\n\n#### 坦克移动功能的实现\n\n```C++\nint do_tank_walk(Tank* tank,DIRECTION dir,IMAGE *img,int step)\n{\n\tint new_x = tank->x;\n\tint new_y = tank->y;\n\tint old_map = map[tank->y][tank->x];\n\tif (step) {\n\t\tif (dir == UP)\n\t\t{\n\t\t\tnew_y--;\n\t\t}\n\t\telse if (dir == DOWN)\n\t\t{\n\t\t\tnew_y++;\n\t\t}\n\t\telse if (dir == LEFT)\n\t\t{\n\t\t\tnew_x--;\n\t\t}\n\t\telse if (dir == RIGHT)\n\t\t{\n\t\t\tnew_x++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\t//清除地图数组上原坦克位置\n\t\tset_map(tank->x, tank->y, 0);\n\t}\n\t//擦除原位置的坦克图像\n\tsetfillcolor(BLACK);\n\tsolidrectangle(tank->x * 25, tank->y * 25, tank->x * 25 + 50, tank->y * 25 + 50);\n\tif (step)\n\t{\n\t\t//更新地图数组坦克位置\n\n\t\tset_map(new_x, new_y, old_map);\n\n\t\t//更新坦克坐标\n\t\ttank->x = new_x;\n\t\ttank->y = new_y;\n\t}\n\t//调整方向应在外部实现，否则会传入键入前的坦克方向\n\t//调整方向\n\t//tank->direction = dir;\n\tputimage(tank->x * 25, tank->y * 25, img);\n\treturn 1;\n}\n```\n\n坦克移动的实现还需要设置地图数据的函数，这个函数主要是简化代码，因为每个坦克都会占据 4 个地图单位所以每次移动都需要把重新设置地图数组上四个数据\n\n```C++\nvoid set_map(int x,int y,int val)\n{\n\tmap[y][x] = val;\n\tmap[y][x+1] = val;\n\tmap[y+1][x] = val;\n\tmap[y+1][x+1] = val;\n}\n```\n\n#### 坦克炮击功能\n\n\n```C++\nvoid tank_fire(Tank* tank, Bullet* bullet)\n{\n\tif (!bullet->status)\n\t{\n\t\t//PlaySound(_T(\"paoji.wav\"), NULL, SND_FILENAME | SND_ASYNC);\n\t\tif (tank->direction == UP)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 + 23;\n\t\t\tbullet->pos_y = tank->y * 25 - 3;\n\t\t}\n\t\telse if (tank->direction == LEFT)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 - 3;\n\t\t\tbullet->pos_y = tank->y * 25 + 23;\n\t\t}\n\t\telse if (tank->direction == DOWN)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 + 23;\n\t\t\tbullet->pos_y = tank->y * 25 + 50;\n\t\t}\n\t\telse if (tank->direction == RIGHT)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 + 50;\n\t\t\tbullet->pos_y = tank->y * 25 + 23;\n\t\t}\n\t\t//获取子弹方向\n\t\tbullet->direction = tank->direction;\n\t\t//改变子弹状态\n\t\tbullet->status = !bullet->status;\n\t}\n}\n\nint bullet_action(Bullet* bullet,Tank* enemy_tank,int Is_Mytank)\n{\n\t//子弹在地图中二维数组的坐标\n\tint x, y,x1,y1;\n\tx = bullet->pos_x / 25;\n\ty = bullet->pos_y / 25;\n\n\t//擦除上一次绘制的子弹\n\tsetfillcolor(BLACK);\n\tsolidrectangle(bullet->pos_x, bullet->pos_y, bullet->pos_x+3, bullet->pos_y+3);\n\n\t//根据方向计算子弹的坐标\n\tif (bullet->direction == UP)\n\t{\n\t\tbullet->pos_y -= 2;\n\t\tx1 = x + 1;\n\t\ty1 = y;\n\t}\n\telse if (bullet->direction == DOWN)\n\t{\n\t\tbullet->pos_y += 2;\n\t\tx1 = x + 1;\n\t\ty1 = y;\n\t}\n\telse if (bullet->direction == LEFT)\n\t{\n\t\tbullet->pos_x -= 2;\n\t\tx1 = x;\n\t\ty1 = y + 1;\n\t}\n\telse if (bullet->direction == RIGHT)\n\t{\n\t\tbullet->pos_x += 2;\n\t\tx1 = x;\n\t\ty1 = y + 1;\n\t}\n\telse\n\t{\n\t\treturn 0;\n\t}\n\tif (bullet->pos_x < 0 || bullet->pos_x>650 || bullet->pos_y < 0 || bullet->pos_y>650)\n\t{\n\t\tbullet->status = 0;\n\t\treturn 0;\n\t}\n\t\n\t//碰撞检查\n\tif (map[y][x] == 4 || map[y1][y1] == 4)\n\t{\n\t\tbullet->status = 0;\n\t\tPlaySound(_T(\"boom.wav\"), NULL, SND_FILENAME | SND_ASYNC);\n\t\treturn 1;\n\t}\n\n\t//击中我方坦克\n\tif (map[y][x] == 200 || map[y1][x1] == 200)\n\t{\n\t\t//判断是否是敌方坦克发射的子弹\n\t\tif(Is_Mytank==0)\n\t\treturn 1;\n\t}\n\n\t//击中敌方坦克\n\tif ((map[y][x] >= 100 && map[y][x] <= 109) || (map[y1][x1] >= 100 && map[y1][x1] <= 109))\n\t{\n\t\t//判断是否是我方发射的子弹\n\t\tif (Is_Mytank == 1)\n\t\t{\n\t\t\tTank* tank = NULL;\n\t\t\tbullet->status = 0;\n\t\t\tif (map[y][x] > 100 && map[y][x] <= 109)\n\t\t\t\ttank = enemy_tank + (map[y][x] - 100);\n\t\t\telse\n\t\t\t\ttank = enemy_tank + (map[y1][x1] - 100);\n\n\t\t\ttank->live = 0;\n\t\t\tset_map(tank->x, tank->y, 0);\n\t\t\tsetfillcolor(BLACK);\n\t\t\tsolidrectangle(tank->x * 25, tank->y * 25, tank->x * 25 + 50, tank->y * 25 + 50);\n\t\t}\n\t}\n\n\n\t//子弹击中可消除的墙\n\tif (map[y][x] == 1)\n\t{\n\t\tmap[y][x] = 0;\n\t\tbullet->status = 0;\n\t\tsetfillcolor(BLACK);\n\t\tsolidrectangle(x * 25, y * 25, x * 25 + 25, y * 25 + 25);\n\t}\n\telse if(map[y][x]==2)//击中不可消除的墙\n\t{\n\t\tbullet->status = 0;\n\t}\n\t//子弹击中可消除的墙\n\tif (map[y1][x1] == 1)\n\t{\n\t\tmap[y1][x1] = 0;\n\t\tbullet->status = 0;\n\t\tsetfillcolor(BLACK);\n\t\tsolidrectangle(x1 * 25, y1 * 25, x1 * 25 + 25, y1 * 25 + 25);\n\t}\n\telse if (map[y1][x1] == 2)//击中不可消除的墙\n\t{\n\t\tbullet->status = 0;\n\t}\n\n\n\t//重新绘制子弹\n\tif (bullet->status)\n\t{\n\t\tsetfillcolor(WHITE);\n\t\tsolidrectangle(bullet->pos_x, bullet->pos_y, bullet->pos_x + 3, bullet->pos_y + 3);\n\t}\n\treturn 0;\n}\n```\n\n#### 敌方坦克的实现\n\n\n```C++\n//设置敌方坦克出场位置\nfor (int i = 0;i < enemy_num;i++)\n{\n\tif (i % 3 == 0)\n\t{\n\t\tenemy_tank[i].x = 0;\n\t}\n\telse if (i % 3 == 1)\n\t{\n\t\tenemy_tank[i].x = 12;\n\t}\n\telse if (i % 3 == 2)\n\t{\n\t\tenemy_tank[i].x = 24;\n\t}\n\tenemy_tank[i].y = 0;\n\tenemy_tank[i].live = 1;\n\tenemy_tank[i].direction = DOWN;\n\tenemy_tank[i].Is_Mycamp = 0;\n\t//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\tenemy_bullet[i].status = 0;\n}\n\nenemy_total = 3;\n//enemy_tank[0].x = 4;\n//enemy_tank[0].y = 0;\n//enemy_tank[0].live = 0;\n//敌方坦克登场\nfor (int i = 0;i < enemy_total;i++)\n{\n\tif (enemy_tank[i].live)\n\t{\n\t\tset_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\t\tdo_tank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction], 0);\n\t}\n\n```\n\n#### 敌方坦克的路由控制\n\n首先我们设置敌方坦克会不断移动，那么我们只需要控制他的方向，让他的移动方向面向目标，如果有障碍物，可以通过炮击清除障碍物\n\n```c++\n\t\t//防止坦克出生重叠\n\t\tif (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == 0)\n\t\t{\n\t\t\tif (times > 0 && times % 1000 == 0 && enemy_total < enemy_num)\n\t\t\t{\n\t\t\t\tset_map(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, 100 + enemy_total);\n\t\t\t\tenemy_total++;\n\t\t\t}\n\t\t}\n\t\tif (times>0 && times % 200 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (!enemy_tank[i].live)\n\t\t\t\t\tcontinue;\n\t\t\t\t//攻击我方老巢\n\t\t\t\tif (i % 2 == 0)\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], 12, 24);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], my_tank.x, my_tank.y);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\ttank_fire(&enemy_tank[i], &enemy_bullet[i]);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t//0.5s移动一次敌方坦克\n\t\telse if (times % 50 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (enemy_tank[i].live)\n\t\t\t\t{\n\t\t\t\t\ttank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n```\n\n#### 游戏结束场景的实现\n\n炮击函数中会返回一个游戏状态值，如果该状态值为真（1），则 game 函数就返回 0，如果敌方坦克全部歼灭，则返回 1，将该数值传入 gameover（）中，如果为 1 则显示胜利图像，如果为 0 则显示失败的图像，然后在 display 的循环中，如果为 1 则 stage+1，将该值传递给 game（）就可以进行下一关游戏\n\n```C++\n\n```","source":"_posts/hello.md","raw":"---\ntitle: 坦克大战（IKUN版）\ndate: 2023-04-20 22:19:13\ntags: hey\ncategories: haha\n---\n# C 语言坦克大战（IKUN 版）\n\n**前言：该坦克大战基于 90 经典坦克大战，对地图音乐等元素进行重新定制，实现成分十足的 IKUN 版坦克大战**\n\n**设计思路：把地图和坦克在地图上的位置都存储在一个二维数组里，坦克的移动，地图的破环以及碰撞检测都是通过修改或是检查二维数组的数据实现，以下是设计的过程**\n\n## 游戏窗口的实现\n\n通过 easyx 库中所提供的函数实现\n\n### 初始化一个 650* 650（单位：像素）大小的窗口\n\n```C++\n//初始化窗口\n\tinitgraph(650, 650);\n```\n\n### 菜单功能\n\n#### 菜单显示\n\n```C++\n//显示主菜单\nIMAGE display_1_img;\nloadimage(&display_1_img, _T(\"display_1.png\"), 650, 650);\nputimage(0, 0, &display_1_img);\n//help菜单图片\nIMAGE help_img;//help菜单图片\nloadimage(&help_img, _T(\"help.bmp\"), 650, 650);//加载图片\n```\n\n主菜单我采用了直接制作一张完整的图片然后覆盖整个窗口\n\n可以采用 easyx 中自带的绘制图形或输出文字的函数，如果要改变菜单按钮等可以直接修改代码完成，如果用整图的话就需要重新制图。\n\n主菜单的帮助界面我采用直接显示一张完整的图，所以先提前加载一下图片\n\n#### 菜单按钮实现\n\n```C++\nMOUSEMSG mouse; //储存鼠标信息变量\n```\n首先定义一个变量存储鼠标信息，通过获取到的鼠标信息在进行选择操作\n\n```C++\n//int finish = 1;//用于结束主菜单循环\n\n//主菜单按钮功能实现\nwhile (1) \n{\n\tmouse = GetMouseMsg();\n\n\tswitch (mouse.uMsg)\n\t{\n\t//help功能显示\n\tcase WM_MOUSEMOVE:\n\t\tif (mouse.x > 245 && mouse.x <430 && mouse.y>320 && mouse.y < 385)\n\t\t\tputimage(0, 0, &help_img);\n\t\telse\n\t\t\tputimage(0, 0, &display_1_img);\n\t\tbreak;\n\tcase WM_LBUTTONDOWN:\n\t\tif (mouse.x > 245 && mouse.x < 430 && mouse.y>155 && mouse.y < 225)\n\t\t{\n\t\t\tsetbkcolor(BLACK);//设置背景色\n\t\t\tcleardevice();\n\t\t\tint stage = 1;\n\t\t\twhile (1)\n\t\t\t{\n\t\t\t\tint result = game(stage);\n\t\t\t\tgameover(result);\n\t\t\t\twhile (1)\n\t\t\t\t{\n\t\t\t\t\tsystem(\"pause\");\n\t\t\t\t\tif (KEY_DOWN(Key_ENTER))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (result)\n\t\t\t\t\tstage++;\n\t\t\t}\n\t\t\t\n\t\t\tfinish = 0;\n\t\t\tbreak;\n\t\t}\n\t\telse if (mouse.x > 245 && mouse.x < 430 && mouse.y>235 && mouse.y < 300)\n\t\t{\n\t\t\tgame();\n\t\t\tbreak;\n\t\t}\n\t\telse if (mouse.x > 245 && mouse.x < 430 && mouse.y>400 && mouse.y < 470)\n\t\t{\n\t\t\texit(0);\n\t\t\tbreak;\n\t\t}\n\t}\n```\n\n这里先说明一下第一个 case 语句，**WM_MOUSEMOVE** 获取的是鼠标的移动信息，在鼠标移动的时候就进入该 case 语句，然后后面的 if 语句则进行判断，如果鼠标移动的区域在 help 框的范围那么就显示 help 图片，如果没有的话就显示主菜单的图片\n\n然后再说明一下第二个 case 语句， **WM_LBUTTONDOWN** 可以获取鼠标的左键点击信息，如果按下左键则进入该语句，同样也是通过 if 语句判断鼠标点击的位置执行不同的操作，首先说最后一个，当我们点击 exit 框的时候就直接执行 exit（0）终止程序\n\n然后说明一下第一个 if 语句，当我们点击 **new game** 时则直接进行游戏\n\n如果点击 **continue** 则会加载游戏存档，继续上一次的游戏，继续游戏和新游戏公用一个函数，通过传递不同的参数值，来选择进入 **game()** 的时候是直接初始化，还是使用存档中的内容进行初始化操作\n\n## 游戏模块\n\n#### 地图的加载以及显示\n\n```C++\n//首先在game（）函数实现的中定义一个全局二维数组以存储地图信息\nint map[map_row][map_col];//map_row,map_col为地图的长和宽，也是地图数组行和列的大小（在gamesettings.h中定义）\n\n//然后是地图资源的加载，需要从文件中加载地图资源并存储到map数组中\nvoid loadmap(int stage)\n{\n\t//地图文件流\n\tifstream map_file;\n\t//保存地图文件名\n\twstring temp;\n\ttemp = map_file_path;\n\ttemp += map_file_name;\n\tint text = 0;\n\tmap_file.open(temp);\n\tif (!map_file.is_open())\n\t{\n\t\ttext = 1;\n\t\tcout << \"打开地图失败！\" << endl;\n\t\t//exit(1);\n\t}\n\n\t//调整文件读取位置，到最大关卡数之后则从第一关开始\n\tstage -= 1;\n\tstage = stage % max_stage;\n\tmap_file.seekg(stage * map_row * map_col * 2);\n\tint num_temp;\n\tfor (int row = 0;row < map_row;row++)\n\t\tfor (int col = 0;col < map_col;col++)\n\t\t{\n\t\t\tmap_file >> dec >> num_temp;\n\t\t\tmap[row][col] = num_temp;\n\t\t}\n\tmap_file.close();\n\n}\n\n//地图显示函数\nvoid Map(int stage) {\n\tint row, col;\n\tIMAGE img_home, img_wall_1, img_wall_2;\n\n\tloadimage(&img_home, _T(\"home_1.jpg\"), 50, 50);// 老鹰\n\tloadimage(&img_wall_1, _T(\"wall_1.jpg\"), 25, 25);//不可消除的墙\n\tloadimage(&img_wall_2, _T(\"wall_2.jpg\"), 25, 25);//可消除的墙\n\n\n\tfor (i = 0; i < 26; i++) {\n\t\tfor (j = 0; j < 26; j++) {\n\t\t\tif (map[i][j] == 1) {\n\t\t\t\tputimage(25 * j, 25 * i, &img_wall_1);\n\t\t\t}\n\t\t\telse if (map[i][j] == 2) {\n\t\t\t\tputimage(25 * j, 25 * i, &img_wall_2);\n\t\t\t}\n\t\t\telse if (map[i][j] == 3) {\n\t\t\t\tputimage(25 * j, 25 * i, &img_home);\n\n\t\t\t\tmap[i][j] = 4;\n\t\t\t\tmap[i][j + 1] = 4;\n\t\t\t\tmap[i + 1][j] = 4;\n\t\t\t\tmap[i + 1][j + 1] = 4;\n\t\t\t}\n\t\t}\n\t}\n}\n```\n\ngame ()函数\n\n```C++\nint game(int stage)\n{\n\tsetbkcolor(BLACK);//设置背景色\n\tcleardevice();\n\t//背景音乐\n\tmciSendString(_T(\"play cxk_1.mp3 repeat\"), NULL, 0, NULL);\n\t//初始化随机数种子\n\tsrand((unsigned int)time(NULL));\n\t\n\n\t//我方坦克\n\tTank my_tank;\n\t//我方坦克发射的子弹\n\tBullet my_bullet;\n\n\t//敌方坦克\n\tTank enemy_tank[enemy_num];\n\t//敌方坦克发射的子弹\n\tBullet enemy_bullet[enemy_num];\n\n\n\t//加载地图\n\tloadmap(stage);\n\tMap(stage);\n\n\t//记录当前的程序的休眠次数，每次10ms\n\tint times = 0;\n\t//敌方坦克存在数量\n\tint enemy_total = 0;\n\t//子弹目前不存在\n\tmy_bullet.status = 0;\n\t\n\t//测试\n\t\n\n\t//加载坦克图片\n\tIMAGE img_mytank[DIRECTIONCOUNT];\n\tIMAGE img_enemytank[DIRECTIONCOUNT];\n\tloadimage(&img_mytank[UP], mytank_filename[UP], 50, 50);\n\tloadimage(&img_mytank[DOWN], mytank_filename[DOWN], 50, 50);\n\tloadimage(&img_mytank[LEFT],mytank_filename[LEFT], 50, 50);\n\tloadimage(&img_mytank[RIGHT], mytank_filename[RIGHT], 50, 50);\n\tloadimage(&img_enemytank[UP], enemytank_filename[UP], 50, 50);\n\tloadimage(&img_enemytank[DOWN], enemytank_filename[DOWN], 50, 50);\n\tloadimage(&img_enemytank[LEFT], enemytank_filename[LEFT], 50, 50);\n\tloadimage(&img_enemytank[RIGHT], enemytank_filename[RIGHT], 50, 50);\n\t\t\n\t//初始化坦克\n\tmy_tank.x = 8;\n\tmy_tank.y = 24;\n\tmy_tank.direction = UP;\n\tmy_tank.live = 1;\n\n\tset_map(my_tank.x, my_tank.y, 200);\n\n\t//设置敌方坦克出场位置\n\tfor (int i = 0;i < enemy_num;i++)\n\t{\n\t\tif (i % 3 == 0)\n\t\t{\n\t\t\tenemy_tank[i].x = 0;\n\t\t}\n\t\telse if (i % 3 == 1)\n\t\t{\n\t\t\tenemy_tank[i].x = 12;\n\t\t}\n\t\telse if (i % 3 == 2)\n\t\t{\n\t\t\tenemy_tank[i].x = 24;\n\t\t}\n\t\tenemy_tank[i].y = 0;\n\t\tenemy_tank[i].live = 1;\n\t\tenemy_tank[i].direction = DOWN;\n\t\tenemy_tank[i].Is_Mycamp = 0;\n\t\t//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\t\tenemy_bullet[i].status = 0;\n\t}\n\nenemy_total = 3;\n\t//enemy_tank[0].x = 4;\n\t//enemy_tank[0].y = 0;\n\t//enemy_tank[0].live = 0;\n\t//敌方坦克登场\n\tfor (int i = 0;i < enemy_total;i++)\n\t{\n\t\tif (enemy_tank[i].live)\n\t\t{\n\t\t\tset_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\t\t\tdo_tank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction], 0);\n\t\t}\n\n\t}\n\n\t//显示坦克\t\t\n\tputimage(my_tank.x * 25, my_tank.y * 25, &img_mytank[my_tank.direction]);\n\t\n\t\n\twhile (1)\n\t{\n\t\t//防止坦克出生重叠\n\t\tif (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == 0)\n\t\t{\n\t\t\tif (times > 0 && times % 1000 == 0 && enemy_total < enemy_num)\n\t\t\t{\n\t\t\t\tset_map(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, 100 + enemy_total);\n\t\t\t\tenemy_total++;\n\t\t\t}\n\t\t}\n\t\tif (times>0 && times % 200 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (!enemy_tank[i].live)\n\t\t\t\t\tcontinue;\n\t\t\t\t//攻击我方老巢\n\t\t\t\tif (i % 2 == 0)\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], 12, 24);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], my_tank.x, my_tank.y);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\ttank_fire(&enemy_tank[i], &enemy_bullet[i]);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t//0.5s移动一次敌方坦克\n\t\telse if (times % 50 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (enemy_tank[i].live)\n\t\t\t\t{\n\t\t\t\t\ttank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (times % 10 == 0)\n\t\t{\n\t\t\tif (KEY_DOWN(Key_LEFT))\n\t\t\t{\n\t\t\t\ttank_walk(&my_tank, LEFT, &img_mytank[LEFT]);\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_UP))\n\t\t\t{\n\t\t\t\tif (my_tank.direction == UP && my_tank.y - 1 >= 0 && map[my_tank.y - 1][my_tank.x] == 0 && map[my_tank.y - 1][my_tank.x + 1] == 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tdo_tank_walk(&my_tank, UP, &img_mytank[my_tank.direction], 1);\n\t\t\t\t\t}\n\t\t\t\t\telse if (my_tank.direction != UP)\n\t\t\t\t\t{\n\t\t\t\t\t\tmy_tank.direction = UP;\n\t\t\t\t\t\tdo_tank_walk(&my_tank, UP, &img_mytank[my_tank.direction], 0);\n\t\t\t\t\t}\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_DOWN))\n\t\t\t{\n\t\t\t\tif (my_tank.direction == DOWN && my_tank.y + 2 <= 25 && map[my_tank.y + 2][my_tank.x] == 0 && map[my_tank.y + 2][my_tank.x + 1] == 0)\n\t\t\t\t{\n\t\t\t\t\tdo_tank_walk(&my_tank, DOWN, &img_mytank[my_tank.direction], 1);\n\t\t\t\t}\n\t\t\t\telse if (my_tank.direction != DOWN)\n\t\t\t\t{\n\t\t\t\t\tmy_tank.direction = DOWN;\n\t\t\t\t\tdo_tank_walk(&my_tank, DOWN, &img_mytank[my_tank.direction], 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_RIGHT))\n\t\t\t{\n\t\t\t\tif (my_tank.direction == RIGHT && my_tank.x + 2 <= 25 && map[my_tank.y][my_tank.x + 2] == 0 && map[my_tank.y + 1][my_tank.x + 2] == 0)\n\t\t\t\t{\n\t\t\t\t\tdo_tank_walk(&my_tank, RIGHT, &img_mytank[my_tank.direction], 1);\n\t\t\t\t}\n\t\t\t\telse if (my_tank.direction != RIGHT)\n\t\t\t\t{\n\t\t\t\t\tmy_tank.direction = RIGHT;\n\t\t\t\t\tdo_tank_walk(&my_tank, RIGHT, &img_mytank[my_tank.direction], 0);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//开火\n\t\t\tif (KEY_DOWN(Key_J_Bullut))\n\t\t\t{\n\n\t\t\t\tPlaySound(_T(\"paoji.wav\"), NULL, SND_FILENAME | SND_ASYNC);\n\t\t\t\ttank_fire(&my_tank, &my_bullet);\n\t\t\t}\n\t\t\t//暂停\n\t\t\tif (KEY_DOWN(Key_P_Stop))\n\t\t\t{\n\t\t\t\twhile (1)\n\t\t\t\t{\n\t\t\t\t\tsystem(\"pause\");\n\t\t\t\t\tif (KEY_DOWN(Key_P_Stop))\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (KEY_DOWN(Key_ESC))\n\t\t\t{\n\t\t\t\t\n\t\t\t\tif (1)\n\t\t\t\t{\n\t\t\t\t\tsave(enemy_tank, &my_tank, enemy_total, times,map);\n\t\t\t\t}\n\t\t\t\tdisplay_1();\n\t\t\t\t//break;\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\tif (my_bullet.status)\n\t\t{\n\t\t\tif (bullet_action(&my_bullet, enemy_tank, my_tank.Is_Mycamp))\n\t\t\t{\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t}\n\t\tfor (int i = 0;i < enemy_num;i++)\n\t\t{\n\t\t\tif (enemy_bullet[i].status)\n\t\t\t{\n\t\t\t\tif (bullet_action(&enemy_bullet[i], enemy_tank,0))\n\t\t\t\t{\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//判断敌方坦克是否全部消灭\n\t\tint isWin = 0;\n\t\tfor (int i = 0;i < enemy_num;i++)\n\t\t{\n\t\t\tif (enemy_tank[i].live == 0)\n\t\t\t\tisWin++;\n\t\t\tif (isWin == 10)\n\t\t\t\treturn 1;\n\t\t}\n\t\tSleep(10);\n\t\ttimes++;\n\t}\n}\n```\n\n#### 坦克移动功能的实现\n\n```C++\nint do_tank_walk(Tank* tank,DIRECTION dir,IMAGE *img,int step)\n{\n\tint new_x = tank->x;\n\tint new_y = tank->y;\n\tint old_map = map[tank->y][tank->x];\n\tif (step) {\n\t\tif (dir == UP)\n\t\t{\n\t\t\tnew_y--;\n\t\t}\n\t\telse if (dir == DOWN)\n\t\t{\n\t\t\tnew_y++;\n\t\t}\n\t\telse if (dir == LEFT)\n\t\t{\n\t\t\tnew_x--;\n\t\t}\n\t\telse if (dir == RIGHT)\n\t\t{\n\t\t\tnew_x++;\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn 0;\n\t\t}\n\t\t//清除地图数组上原坦克位置\n\t\tset_map(tank->x, tank->y, 0);\n\t}\n\t//擦除原位置的坦克图像\n\tsetfillcolor(BLACK);\n\tsolidrectangle(tank->x * 25, tank->y * 25, tank->x * 25 + 50, tank->y * 25 + 50);\n\tif (step)\n\t{\n\t\t//更新地图数组坦克位置\n\n\t\tset_map(new_x, new_y, old_map);\n\n\t\t//更新坦克坐标\n\t\ttank->x = new_x;\n\t\ttank->y = new_y;\n\t}\n\t//调整方向应在外部实现，否则会传入键入前的坦克方向\n\t//调整方向\n\t//tank->direction = dir;\n\tputimage(tank->x * 25, tank->y * 25, img);\n\treturn 1;\n}\n```\n\n坦克移动的实现还需要设置地图数据的函数，这个函数主要是简化代码，因为每个坦克都会占据 4 个地图单位所以每次移动都需要把重新设置地图数组上四个数据\n\n```C++\nvoid set_map(int x,int y,int val)\n{\n\tmap[y][x] = val;\n\tmap[y][x+1] = val;\n\tmap[y+1][x] = val;\n\tmap[y+1][x+1] = val;\n}\n```\n\n#### 坦克炮击功能\n\n\n```C++\nvoid tank_fire(Tank* tank, Bullet* bullet)\n{\n\tif (!bullet->status)\n\t{\n\t\t//PlaySound(_T(\"paoji.wav\"), NULL, SND_FILENAME | SND_ASYNC);\n\t\tif (tank->direction == UP)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 + 23;\n\t\t\tbullet->pos_y = tank->y * 25 - 3;\n\t\t}\n\t\telse if (tank->direction == LEFT)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 - 3;\n\t\t\tbullet->pos_y = tank->y * 25 + 23;\n\t\t}\n\t\telse if (tank->direction == DOWN)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 + 23;\n\t\t\tbullet->pos_y = tank->y * 25 + 50;\n\t\t}\n\t\telse if (tank->direction == RIGHT)\n\t\t{\n\t\t\t//子弹绘图坐标修正\n\t\t\tbullet->pos_x = tank->x * 25 + 50;\n\t\t\tbullet->pos_y = tank->y * 25 + 23;\n\t\t}\n\t\t//获取子弹方向\n\t\tbullet->direction = tank->direction;\n\t\t//改变子弹状态\n\t\tbullet->status = !bullet->status;\n\t}\n}\n\nint bullet_action(Bullet* bullet,Tank* enemy_tank,int Is_Mytank)\n{\n\t//子弹在地图中二维数组的坐标\n\tint x, y,x1,y1;\n\tx = bullet->pos_x / 25;\n\ty = bullet->pos_y / 25;\n\n\t//擦除上一次绘制的子弹\n\tsetfillcolor(BLACK);\n\tsolidrectangle(bullet->pos_x, bullet->pos_y, bullet->pos_x+3, bullet->pos_y+3);\n\n\t//根据方向计算子弹的坐标\n\tif (bullet->direction == UP)\n\t{\n\t\tbullet->pos_y -= 2;\n\t\tx1 = x + 1;\n\t\ty1 = y;\n\t}\n\telse if (bullet->direction == DOWN)\n\t{\n\t\tbullet->pos_y += 2;\n\t\tx1 = x + 1;\n\t\ty1 = y;\n\t}\n\telse if (bullet->direction == LEFT)\n\t{\n\t\tbullet->pos_x -= 2;\n\t\tx1 = x;\n\t\ty1 = y + 1;\n\t}\n\telse if (bullet->direction == RIGHT)\n\t{\n\t\tbullet->pos_x += 2;\n\t\tx1 = x;\n\t\ty1 = y + 1;\n\t}\n\telse\n\t{\n\t\treturn 0;\n\t}\n\tif (bullet->pos_x < 0 || bullet->pos_x>650 || bullet->pos_y < 0 || bullet->pos_y>650)\n\t{\n\t\tbullet->status = 0;\n\t\treturn 0;\n\t}\n\t\n\t//碰撞检查\n\tif (map[y][x] == 4 || map[y1][y1] == 4)\n\t{\n\t\tbullet->status = 0;\n\t\tPlaySound(_T(\"boom.wav\"), NULL, SND_FILENAME | SND_ASYNC);\n\t\treturn 1;\n\t}\n\n\t//击中我方坦克\n\tif (map[y][x] == 200 || map[y1][x1] == 200)\n\t{\n\t\t//判断是否是敌方坦克发射的子弹\n\t\tif(Is_Mytank==0)\n\t\treturn 1;\n\t}\n\n\t//击中敌方坦克\n\tif ((map[y][x] >= 100 && map[y][x] <= 109) || (map[y1][x1] >= 100 && map[y1][x1] <= 109))\n\t{\n\t\t//判断是否是我方发射的子弹\n\t\tif (Is_Mytank == 1)\n\t\t{\n\t\t\tTank* tank = NULL;\n\t\t\tbullet->status = 0;\n\t\t\tif (map[y][x] > 100 && map[y][x] <= 109)\n\t\t\t\ttank = enemy_tank + (map[y][x] - 100);\n\t\t\telse\n\t\t\t\ttank = enemy_tank + (map[y1][x1] - 100);\n\n\t\t\ttank->live = 0;\n\t\t\tset_map(tank->x, tank->y, 0);\n\t\t\tsetfillcolor(BLACK);\n\t\t\tsolidrectangle(tank->x * 25, tank->y * 25, tank->x * 25 + 50, tank->y * 25 + 50);\n\t\t}\n\t}\n\n\n\t//子弹击中可消除的墙\n\tif (map[y][x] == 1)\n\t{\n\t\tmap[y][x] = 0;\n\t\tbullet->status = 0;\n\t\tsetfillcolor(BLACK);\n\t\tsolidrectangle(x * 25, y * 25, x * 25 + 25, y * 25 + 25);\n\t}\n\telse if(map[y][x]==2)//击中不可消除的墙\n\t{\n\t\tbullet->status = 0;\n\t}\n\t//子弹击中可消除的墙\n\tif (map[y1][x1] == 1)\n\t{\n\t\tmap[y1][x1] = 0;\n\t\tbullet->status = 0;\n\t\tsetfillcolor(BLACK);\n\t\tsolidrectangle(x1 * 25, y1 * 25, x1 * 25 + 25, y1 * 25 + 25);\n\t}\n\telse if (map[y1][x1] == 2)//击中不可消除的墙\n\t{\n\t\tbullet->status = 0;\n\t}\n\n\n\t//重新绘制子弹\n\tif (bullet->status)\n\t{\n\t\tsetfillcolor(WHITE);\n\t\tsolidrectangle(bullet->pos_x, bullet->pos_y, bullet->pos_x + 3, bullet->pos_y + 3);\n\t}\n\treturn 0;\n}\n```\n\n#### 敌方坦克的实现\n\n\n```C++\n//设置敌方坦克出场位置\nfor (int i = 0;i < enemy_num;i++)\n{\n\tif (i % 3 == 0)\n\t{\n\t\tenemy_tank[i].x = 0;\n\t}\n\telse if (i % 3 == 1)\n\t{\n\t\tenemy_tank[i].x = 12;\n\t}\n\telse if (i % 3 == 2)\n\t{\n\t\tenemy_tank[i].x = 24;\n\t}\n\tenemy_tank[i].y = 0;\n\tenemy_tank[i].live = 1;\n\tenemy_tank[i].direction = DOWN;\n\tenemy_tank[i].Is_Mycamp = 0;\n\t//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\tenemy_bullet[i].status = 0;\n}\n\nenemy_total = 3;\n//enemy_tank[0].x = 4;\n//enemy_tank[0].y = 0;\n//enemy_tank[0].live = 0;\n//敌方坦克登场\nfor (int i = 0;i < enemy_total;i++)\n{\n\tif (enemy_tank[i].live)\n\t{\n\t\tset_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);\n\t\tdo_tank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction], 0);\n\t}\n\n```\n\n#### 敌方坦克的路由控制\n\n首先我们设置敌方坦克会不断移动，那么我们只需要控制他的方向，让他的移动方向面向目标，如果有障碍物，可以通过炮击清除障碍物\n\n```c++\n\t\t//防止坦克出生重叠\n\t\tif (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == 0)\n\t\t{\n\t\t\tif (times > 0 && times % 1000 == 0 && enemy_total < enemy_num)\n\t\t\t{\n\t\t\t\tset_map(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, 100 + enemy_total);\n\t\t\t\tenemy_total++;\n\t\t\t}\n\t\t}\n\t\tif (times>0 && times % 200 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (!enemy_tank[i].live)\n\t\t\t\t\tcontinue;\n\t\t\t\t//攻击我方老巢\n\t\t\t\tif (i % 2 == 0)\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], 12, 24);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDIRECTION d = enemy_direction(&enemy_tank[i], my_tank.x, my_tank.y);\n\t\t\t\t\ttank_walk(&enemy_tank[i], d, &img_enemytank[d]);\n\t\t\t\t}\n\t\t\t\ttank_fire(&enemy_tank[i], &enemy_bullet[i]);\n\t\t\t}\n\t\t\t\n\t\t}\n\t\t\n\t\t//0.5s移动一次敌方坦克\n\t\telse if (times % 50 == 0)\n\t\t{\n\t\t\tfor (int i = 0;i < enemy_total;i++)\n\t\t\t{\n\t\t\t\tif (enemy_tank[i].live)\n\t\t\t\t{\n\t\t\t\t\ttank_walk(&enemy_tank[i], enemy_tank[i].direction, &img_enemytank[enemy_tank[i].direction]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n```\n\n#### 游戏结束场景的实现\n\n炮击函数中会返回一个游戏状态值，如果该状态值为真（1），则 game 函数就返回 0，如果敌方坦克全部歼灭，则返回 1，将该数值传入 gameover（）中，如果为 1 则显示胜利图像，如果为 0 则显示失败的图像，然后在 display 的循环中，如果为 1 则 stage+1，将该值传递给 game（）就可以进行下一关游戏\n\n```C++\n\n```","slug":"hello","published":1,"updated":"2023-05-16T10:40:53.145Z","_id":"clgpfcfr20000dovt25jp38wi","comments":1,"layout":"post","photos":[],"link":"","content":"<h1 id=\"C-语言坦克大战（IKUN-版）\"><a href=\"#C-语言坦克大战（IKUN-版）\" class=\"headerlink\" title=\"C 语言坦克大战（IKUN 版）\"></a>C 语言坦克大战（IKUN 版）</h1><p><strong>前言：该坦克大战基于 90 经典坦克大战，对地图音乐等元素进行重新定制，实现成分十足的 IKUN 版坦克大战</strong></p>\n<p><strong>设计思路：把地图和坦克在地图上的位置都存储在一个二维数组里，坦克的移动，地图的破环以及碰撞检测都是通过修改或是检查二维数组的数据实现，以下是设计的过程</strong></p>\n<h2 id=\"游戏窗口的实现\"><a href=\"#游戏窗口的实现\" class=\"headerlink\" title=\"游戏窗口的实现\"></a>游戏窗口的实现</h2><p>通过 easyx 库中所提供的函数实现</p>\n<h3 id=\"初始化一个-650-650（单位：像素）大小的窗口\"><a href=\"#初始化一个-650-650（单位：像素）大小的窗口\" class=\"headerlink\" title=\"初始化一个 650* 650（单位：像素）大小的窗口\"></a>初始化一个 650* 650（单位：像素）大小的窗口</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//初始化窗口</span></span><br><span class=\"line\">\t<span class=\"built_in\">initgraph</span>(<span class=\"number\">650</span>, <span class=\"number\">650</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"菜单功能\"><a href=\"#菜单功能\" class=\"headerlink\" title=\"菜单功能\"></a>菜单功能</h3><h4 id=\"菜单显示\"><a href=\"#菜单显示\" class=\"headerlink\" title=\"菜单显示\"></a>菜单显示</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//显示主菜单</span></span><br><span class=\"line\">IMAGE display_1_img;</span><br><span class=\"line\"><span class=\"built_in\">loadimage</span>(&amp;display_1_img, _T(<span class=\"string\">&quot;display_1.png&quot;</span>), <span class=\"number\">650</span>, <span class=\"number\">650</span>);</span><br><span class=\"line\"><span class=\"built_in\">putimage</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;display_1_img);</span><br><span class=\"line\"><span class=\"comment\">//help菜单图片</span></span><br><span class=\"line\">IMAGE help_img;<span class=\"comment\">//help菜单图片</span></span><br><span class=\"line\"><span class=\"built_in\">loadimage</span>(&amp;help_img, _T(<span class=\"string\">&quot;help.bmp&quot;</span>), <span class=\"number\">650</span>, <span class=\"number\">650</span>);<span class=\"comment\">//加载图片</span></span><br></pre></td></tr></table></figure>\n\n<p>主菜单我采用了直接制作一张完整的图片然后覆盖整个窗口</p>\n<p>可以采用 easyx 中自带的绘制图形或输出文字的函数，如果要改变菜单按钮等可以直接修改代码完成，如果用整图的话就需要重新制图。</p>\n<p>主菜单的帮助界面我采用直接显示一张完整的图，所以先提前加载一下图片</p>\n<h4 id=\"菜单按钮实现\"><a href=\"#菜单按钮实现\" class=\"headerlink\" title=\"菜单按钮实现\"></a>菜单按钮实现</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MOUSEMSG mouse; <span class=\"comment\">//储存鼠标信息变量</span></span><br></pre></td></tr></table></figure>\n<p>首先定义一个变量存储鼠标信息，通过获取到的鼠标信息在进行选择操作</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//int finish = 1;//用于结束主菜单循环</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//主菜单按钮功能实现</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"number\">1</span>) </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tmouse = <span class=\"built_in\">GetMouseMsg</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> (mouse.uMsg)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//help功能显示</span></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> WM_MOUSEMOVE:</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt;<span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">320</span> &amp;&amp; mouse.y &lt; <span class=\"number\">385</span>)</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;help_img);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;display_1_img);</span><br><span class=\"line\">\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> WM_LBUTTONDOWN:</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt; <span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">155</span> &amp;&amp; mouse.y &lt; <span class=\"number\">225</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">setbkcolor</span>(BLACK);<span class=\"comment\">//设置背景色</span></span><br><span class=\"line\">\t\t\t<span class=\"built_in\">cleardevice</span>();</span><br><span class=\"line\">\t\t\t<span class=\"type\">int</span> stage = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> result = <span class=\"built_in\">game</span>(stage);</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">gameover</span>(result);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">system</span>(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_ENTER))</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (result)</span><br><span class=\"line\">\t\t\t\t\tstage++;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\t\t\tfinish = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt; <span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">235</span> &amp;&amp; mouse.y &lt; <span class=\"number\">300</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">game</span>();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt; <span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">400</span> &amp;&amp; mouse.y &lt; <span class=\"number\">470</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这里先说明一下第一个 case 语句，<strong>WM_MOUSEMOVE</strong> 获取的是鼠标的移动信息，在鼠标移动的时候就进入该 case 语句，然后后面的 if 语句则进行判断，如果鼠标移动的区域在 help 框的范围那么就显示 help 图片，如果没有的话就显示主菜单的图片</p>\n<p>然后再说明一下第二个 case 语句， <strong>WM_LBUTTONDOWN</strong> 可以获取鼠标的左键点击信息，如果按下左键则进入该语句，同样也是通过 if 语句判断鼠标点击的位置执行不同的操作，首先说最后一个，当我们点击 exit 框的时候就直接执行 exit（0）终止程序</p>\n<p>然后说明一下第一个 if 语句，当我们点击 <strong>new game</strong> 时则直接进行游戏</p>\n<p>如果点击 <strong>continue</strong> 则会加载游戏存档，继续上一次的游戏，继续游戏和新游戏公用一个函数，通过传递不同的参数值，来选择进入 <strong>game()</strong> 的时候是直接初始化，还是使用存档中的内容进行初始化操作</p>\n<h2 id=\"游戏模块\"><a href=\"#游戏模块\" class=\"headerlink\" title=\"游戏模块\"></a>游戏模块</h2><h4 id=\"地图的加载以及显示\"><a href=\"#地图的加载以及显示\" class=\"headerlink\" title=\"地图的加载以及显示\"></a>地图的加载以及显示</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//首先在game（）函数实现的中定义一个全局二维数组以存储地图信息</span></span><br><span class=\"line\"><span class=\"type\">int</span> map[map_row][map_col];<span class=\"comment\">//map_row,map_col为地图的长和宽，也是地图数组行和列的大小（在gamesettings.h中定义）</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//然后是地图资源的加载，需要从文件中加载地图资源并存储到map数组中</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">loadmap</span><span class=\"params\">(<span class=\"type\">int</span> stage)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//地图文件流</span></span><br><span class=\"line\">\tifstream map_file;</span><br><span class=\"line\">\t<span class=\"comment\">//保存地图文件名</span></span><br><span class=\"line\">\twstring temp;</span><br><span class=\"line\">\ttemp = map_file_path;</span><br><span class=\"line\">\ttemp += map_file_name;</span><br><span class=\"line\">\t<span class=\"type\">int</span> text = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tmap_file.<span class=\"built_in\">open</span>(temp);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!map_file.<span class=\"built_in\">is_open</span>())</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\ttext = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tcout &lt;&lt; <span class=\"string\">&quot;打开地图失败！&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">\t\t<span class=\"comment\">//exit(1);</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//调整文件读取位置，到最大关卡数之后则从第一关开始</span></span><br><span class=\"line\">\tstage -= <span class=\"number\">1</span>;</span><br><span class=\"line\">\tstage = stage % max_stage;</span><br><span class=\"line\">\tmap_file.<span class=\"built_in\">seekg</span>(stage * map_row * map_col * <span class=\"number\">2</span>);</span><br><span class=\"line\">\t<span class=\"type\">int</span> num_temp;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> row = <span class=\"number\">0</span>;row &lt; map_row;row++)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> col = <span class=\"number\">0</span>;col &lt; map_col;col++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tmap_file &gt;&gt; dec &gt;&gt; num_temp;</span><br><span class=\"line\">\t\t\tmap[row][col] = num_temp;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\tmap_file.<span class=\"built_in\">close</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//地图显示函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Map</span><span class=\"params\">(<span class=\"type\">int</span> stage)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> row, col;</span><br><span class=\"line\">\tIMAGE img_home, img_wall_1, img_wall_2;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_home, _T(<span class=\"string\">&quot;home_1.jpg&quot;</span>), <span class=\"number\">50</span>, <span class=\"number\">50</span>);<span class=\"comment\">// 老鹰</span></span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_wall_1, _T(<span class=\"string\">&quot;wall_1.jpg&quot;</span>), <span class=\"number\">25</span>, <span class=\"number\">25</span>);<span class=\"comment\">//不可消除的墙</span></span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_wall_2, _T(<span class=\"string\">&quot;wall_2.jpg&quot;</span>), <span class=\"number\">25</span>, <span class=\"number\">25</span>);<span class=\"comment\">//可消除的墙</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">26</span>; j++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (map[i][j] == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">25</span> * j, <span class=\"number\">25</span> * i, &amp;img_wall_1);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (map[i][j] == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">25</span> * j, <span class=\"number\">25</span> * i, &amp;img_wall_2);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (map[i][j] == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">25</span> * j, <span class=\"number\">25</span> * i, &amp;img_home);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\tmap[i][j] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t\tmap[i][j + <span class=\"number\">1</span>] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t\tmap[i + <span class=\"number\">1</span>][j] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t\tmap[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>game ()函数</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">game</span><span class=\"params\">(<span class=\"type\">int</span> stage)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">setbkcolor</span>(BLACK);<span class=\"comment\">//设置背景色</span></span><br><span class=\"line\">\t<span class=\"built_in\">cleardevice</span>();</span><br><span class=\"line\">\t<span class=\"comment\">//背景音乐</span></span><br><span class=\"line\">\t<span class=\"built_in\">mciSendString</span>(_T(<span class=\"string\">&quot;play cxk_1.mp3 repeat&quot;</span>), <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//初始化随机数种子</span></span><br><span class=\"line\">\t<span class=\"built_in\">srand</span>((<span class=\"type\">unsigned</span> <span class=\"type\">int</span>)<span class=\"built_in\">time</span>(<span class=\"literal\">NULL</span>));</span><br><span class=\"line\">\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//我方坦克</span></span><br><span class=\"line\">\tTank my_tank;</span><br><span class=\"line\">\t<span class=\"comment\">//我方坦克发射的子弹</span></span><br><span class=\"line\">\tBullet my_bullet;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克</span></span><br><span class=\"line\">\tTank enemy_tank[enemy_num];</span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克发射的子弹</span></span><br><span class=\"line\">\tBullet enemy_bullet[enemy_num];</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//加载地图</span></span><br><span class=\"line\">\t<span class=\"built_in\">loadmap</span>(stage);</span><br><span class=\"line\">\t<span class=\"built_in\">Map</span>(stage);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//记录当前的程序的休眠次数，每次10ms</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> times = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克存在数量</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> enemy_total = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//子弹目前不存在</span></span><br><span class=\"line\">\tmy_bullet.status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//测试</span></span><br><span class=\"line\">\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//加载坦克图片</span></span><br><span class=\"line\">\tIMAGE img_mytank[DIRECTIONCOUNT];</span><br><span class=\"line\">\tIMAGE img_enemytank[DIRECTIONCOUNT];</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[UP], mytank_filename[UP], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[DOWN], mytank_filename[DOWN], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[LEFT],mytank_filename[LEFT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[RIGHT], mytank_filename[RIGHT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[UP], enemytank_filename[UP], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[DOWN], enemytank_filename[DOWN], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[LEFT], enemytank_filename[LEFT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[RIGHT], enemytank_filename[RIGHT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t<span class=\"comment\">//初始化坦克</span></span><br><span class=\"line\">\tmy_tank.x = <span class=\"number\">8</span>;</span><br><span class=\"line\">\tmy_tank.y = <span class=\"number\">24</span>;</span><br><span class=\"line\">\tmy_tank.direction = UP;</span><br><span class=\"line\">\tmy_tank.live = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">set_map</span>(my_tank.x, my_tank.y, <span class=\"number\">200</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//设置敌方坦克出场位置</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tenemy_tank[i].x = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tenemy_tank[i].x = <span class=\"number\">12</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tenemy_tank[i].x = <span class=\"number\">24</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tenemy_tank[i].y = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tenemy_tank[i].live = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tenemy_tank[i].direction = DOWN;</span><br><span class=\"line\">\t\tenemy_tank[i].Is_Mycamp = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);</span></span><br><span class=\"line\">\t\tenemy_bullet[i].status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">enemy_total = <span class=\"number\">3</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//enemy_tank[0].x = 4;</span></span><br><span class=\"line\">\t<span class=\"comment\">//enemy_tank[0].y = 0;</span></span><br><span class=\"line\">\t<span class=\"comment\">//enemy_tank[0].live = 0;</span></span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克登场</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">set_map</span>(enemy_tank[i].x, enemy_tank[i].y, <span class=\"number\">100</span> + i);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//显示坦克\t\t</span></span><br><span class=\"line\">\t<span class=\"built_in\">putimage</span>(my_tank.x * <span class=\"number\">25</span>, my_tank.y * <span class=\"number\">25</span>, &amp;img_mytank[my_tank.direction]);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//防止坦克出生重叠</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (times &gt; <span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">1000</span> == <span class=\"number\">0</span> &amp;&amp; enemy_total &lt; enemy_num)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">set_map</span>(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, <span class=\"number\">100</span> + enemy_total);</span><br><span class=\"line\">\t\t\t\tenemy_total++;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (times&gt;<span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">200</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (!enemy_tank[i].live)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//攻击我方老巢</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], <span class=\"number\">12</span>, <span class=\"number\">24</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], my_tank.x, my_tank.y);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">tank_fire</span>(&amp;enemy_tank[i], &amp;enemy_bullet[i]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">//0.5s移动一次敌方坦克</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (times % <span class=\"number\">50</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (times % <span class=\"number\">10</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_LEFT))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;my_tank, LEFT, &amp;img_mytank[LEFT]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_UP))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (my_tank.direction == UP &amp;&amp; my_tank.y - <span class=\"number\">1</span> &gt;= <span class=\"number\">0</span> &amp;&amp; map[my_tank.y - <span class=\"number\">1</span>][my_tank.x] == <span class=\"number\">0</span> &amp;&amp; map[my_tank.y - <span class=\"number\">1</span>][my_tank.x + <span class=\"number\">1</span>] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, UP, &amp;img_mytank[my_tank.direction], <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (my_tank.direction != UP)</span><br><span class=\"line\">\t\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t\tmy_tank.direction = UP;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, UP, &amp;img_mytank[my_tank.direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_DOWN))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (my_tank.direction == DOWN &amp;&amp; my_tank.y + <span class=\"number\">2</span> &lt;= <span class=\"number\">25</span> &amp;&amp; map[my_tank.y + <span class=\"number\">2</span>][my_tank.x] == <span class=\"number\">0</span> &amp;&amp; map[my_tank.y + <span class=\"number\">2</span>][my_tank.x + <span class=\"number\">1</span>] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, DOWN, &amp;img_mytank[my_tank.direction], <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (my_tank.direction != DOWN)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tmy_tank.direction = DOWN;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, DOWN, &amp;img_mytank[my_tank.direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_RIGHT))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (my_tank.direction == RIGHT &amp;&amp; my_tank.x + <span class=\"number\">2</span> &lt;= <span class=\"number\">25</span> &amp;&amp; map[my_tank.y][my_tank.x + <span class=\"number\">2</span>] == <span class=\"number\">0</span> &amp;&amp; map[my_tank.y + <span class=\"number\">1</span>][my_tank.x + <span class=\"number\">2</span>] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, RIGHT, &amp;img_mytank[my_tank.direction], <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (my_tank.direction != RIGHT)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tmy_tank.direction = RIGHT;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, RIGHT, &amp;img_mytank[my_tank.direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//开火</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_J_Bullut))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">PlaySound</span>(_T(<span class=\"string\">&quot;paoji.wav&quot;</span>), <span class=\"literal\">NULL</span>, SND_FILENAME | SND_ASYNC);</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">tank_fire</span>(&amp;my_tank, &amp;my_bullet);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//暂停</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_P_Stop))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">system</span>(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_P_Stop))</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_ESC))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">save</span>(enemy_tank, &amp;my_tank, enemy_total, times,map);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">display_1</span>();</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//break;</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (my_bullet.status)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">bullet_action</span>(&amp;my_bullet, enemy_tank, my_tank.Is_Mycamp))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (enemy_bullet[i].status)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">bullet_action</span>(&amp;enemy_bullet[i], enemy_tank,<span class=\"number\">0</span>))</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//判断敌方坦克是否全部消灭</span></span><br><span class=\"line\">\t\t<span class=\"type\">int</span> isWin = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\tisWin++;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (isWin == <span class=\"number\">10</span>)</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">Sleep</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\ttimes++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"坦克移动功能的实现\"><a href=\"#坦克移动功能的实现\" class=\"headerlink\" title=\"坦克移动功能的实现\"></a>坦克移动功能的实现</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">do_tank_walk</span><span class=\"params\">(Tank* tank,DIRECTION dir,IMAGE *img,<span class=\"type\">int</span> step)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> new_x = tank-&gt;x;</span><br><span class=\"line\">\t<span class=\"type\">int</span> new_y = tank-&gt;y;</span><br><span class=\"line\">\t<span class=\"type\">int</span> old_map = map[tank-&gt;y][tank-&gt;x];</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (step) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (dir == UP)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_y--;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == DOWN)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_y++;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == LEFT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_x--;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == RIGHT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_x++;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//清除地图数组上原坦克位置</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(tank-&gt;x, tank-&gt;y, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//擦除原位置的坦克图像</span></span><br><span class=\"line\">\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t<span class=\"built_in\">solidrectangle</span>(tank-&gt;x * <span class=\"number\">25</span>, tank-&gt;y * <span class=\"number\">25</span>, tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">50</span>, tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (step)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//更新地图数组坦克位置</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(new_x, new_y, old_map);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">//更新坦克坐标</span></span><br><span class=\"line\">\t\ttank-&gt;x = new_x;</span><br><span class=\"line\">\t\ttank-&gt;y = new_y;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//调整方向应在外部实现，否则会传入键入前的坦克方向</span></span><br><span class=\"line\">\t<span class=\"comment\">//调整方向</span></span><br><span class=\"line\">\t<span class=\"comment\">//tank-&gt;direction = dir;</span></span><br><span class=\"line\">\t<span class=\"built_in\">putimage</span>(tank-&gt;x * <span class=\"number\">25</span>, tank-&gt;y * <span class=\"number\">25</span>, img);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>坦克移动的实现还需要设置地图数据的函数，这个函数主要是简化代码，因为每个坦克都会占据 4 个地图单位所以每次移动都需要把重新设置地图数组上四个数据</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">set_map</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> y,<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tmap[y][x] = val;</span><br><span class=\"line\">\tmap[y][x+<span class=\"number\">1</span>] = val;</span><br><span class=\"line\">\tmap[y+<span class=\"number\">1</span>][x] = val;</span><br><span class=\"line\">\tmap[y+<span class=\"number\">1</span>][x+<span class=\"number\">1</span>] = val;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"坦克炮击功能\"><a href=\"#坦克炮击功能\" class=\"headerlink\" title=\"坦克炮击功能\"></a>坦克炮击功能</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tank_fire</span><span class=\"params\">(Tank* tank, Bullet* bullet)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!bullet-&gt;status)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//PlaySound(_T(&quot;paoji.wav&quot;), NULL, SND_FILENAME | SND_ASYNC);</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (tank-&gt;direction == UP)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> - <span class=\"number\">3</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tank-&gt;direction == LEFT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> - <span class=\"number\">3</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tank-&gt;direction == DOWN)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">50</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tank-&gt;direction == RIGHT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">50</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//获取子弹方向</span></span><br><span class=\"line\">\t\tbullet-&gt;direction = tank-&gt;direction;</span><br><span class=\"line\">\t\t<span class=\"comment\">//改变子弹状态</span></span><br><span class=\"line\">\t\tbullet-&gt;status = !bullet-&gt;status;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">bullet_action</span><span class=\"params\">(Bullet* bullet,Tank* enemy_tank,<span class=\"type\">int</span> Is_Mytank)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//子弹在地图中二维数组的坐标</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> x, y,x1,y1;</span><br><span class=\"line\">\tx = bullet-&gt;pos_x / <span class=\"number\">25</span>;</span><br><span class=\"line\">\ty = bullet-&gt;pos_y / <span class=\"number\">25</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//擦除上一次绘制的子弹</span></span><br><span class=\"line\">\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t<span class=\"built_in\">solidrectangle</span>(bullet-&gt;pos_x, bullet-&gt;pos_y, bullet-&gt;pos_x+<span class=\"number\">3</span>, bullet-&gt;pos_y+<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//根据方向计算子弹的坐标</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (bullet-&gt;direction == UP)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_y -= <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ty1 = y;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bullet-&gt;direction == DOWN)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_y += <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ty1 = y;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bullet-&gt;direction == LEFT)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_x -= <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x;</span><br><span class=\"line\">\t\ty1 = y + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bullet-&gt;direction == RIGHT)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_x += <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x;</span><br><span class=\"line\">\t\ty1 = y + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (bullet-&gt;pos_x &lt; <span class=\"number\">0</span> || bullet-&gt;pos_x&gt;<span class=\"number\">650</span> || bullet-&gt;pos_y &lt; <span class=\"number\">0</span> || bullet-&gt;pos_y&gt;<span class=\"number\">650</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//碰撞检查</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y][x] == <span class=\"number\">4</span> || map[y1][y1] == <span class=\"number\">4</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">PlaySound</span>(_T(<span class=\"string\">&quot;boom.wav&quot;</span>), <span class=\"literal\">NULL</span>, SND_FILENAME | SND_ASYNC);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//击中我方坦克</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y][x] == <span class=\"number\">200</span> || map[y1][x1] == <span class=\"number\">200</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//判断是否是敌方坦克发射的子弹</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(Is_Mytank==<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//击中敌方坦克</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ((map[y][x] &gt;= <span class=\"number\">100</span> &amp;&amp; map[y][x] &lt;= <span class=\"number\">109</span>) || (map[y1][x1] &gt;= <span class=\"number\">100</span> &amp;&amp; map[y1][x1] &lt;= <span class=\"number\">109</span>))</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//判断是否是我方发射的子弹</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (Is_Mytank == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tTank* tank = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (map[y][x] &gt; <span class=\"number\">100</span> &amp;&amp; map[y][x] &lt;= <span class=\"number\">109</span>)</span><br><span class=\"line\">\t\t\t\ttank = enemy_tank + (map[y][x] - <span class=\"number\">100</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\ttank = enemy_tank + (map[y1][x1] - <span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\ttank-&gt;live = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">set_map</span>(tank-&gt;x, tank-&gt;y, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">solidrectangle</span>(tank-&gt;x * <span class=\"number\">25</span>, tank-&gt;y * <span class=\"number\">25</span>, tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">50</span>, tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">50</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//子弹击中可消除的墙</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y][x] == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tmap[y][x] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t\t<span class=\"built_in\">solidrectangle</span>(x * <span class=\"number\">25</span>, y * <span class=\"number\">25</span>, x * <span class=\"number\">25</span> + <span class=\"number\">25</span>, y * <span class=\"number\">25</span> + <span class=\"number\">25</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(map[y][x]==<span class=\"number\">2</span>)<span class=\"comment\">//击中不可消除的墙</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//子弹击中可消除的墙</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y1][x1] == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tmap[y1][x1] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t\t<span class=\"built_in\">solidrectangle</span>(x1 * <span class=\"number\">25</span>, y1 * <span class=\"number\">25</span>, x1 * <span class=\"number\">25</span> + <span class=\"number\">25</span>, y1 * <span class=\"number\">25</span> + <span class=\"number\">25</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (map[y1][x1] == <span class=\"number\">2</span>)<span class=\"comment\">//击中不可消除的墙</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//重新绘制子弹</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (bullet-&gt;status)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">setfillcolor</span>(WHITE);</span><br><span class=\"line\">\t\t<span class=\"built_in\">solidrectangle</span>(bullet-&gt;pos_x, bullet-&gt;pos_y, bullet-&gt;pos_x + <span class=\"number\">3</span>, bullet-&gt;pos_y + <span class=\"number\">3</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"敌方坦克的实现\"><a href=\"#敌方坦克的实现\" class=\"headerlink\" title=\"敌方坦克的实现\"></a>敌方坦克的实现</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//设置敌方坦克出场位置</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tenemy_tank[i].x = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tenemy_tank[i].x = <span class=\"number\">12</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">2</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tenemy_tank[i].x = <span class=\"number\">24</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tenemy_tank[i].y = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tenemy_tank[i].live = <span class=\"number\">1</span>;</span><br><span class=\"line\">\tenemy_tank[i].direction = DOWN;</span><br><span class=\"line\">\tenemy_tank[i].Is_Mycamp = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);</span></span><br><span class=\"line\">\tenemy_bullet[i].status = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">enemy_total = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"comment\">//enemy_tank[0].x = 4;</span></span><br><span class=\"line\"><span class=\"comment\">//enemy_tank[0].y = 0;</span></span><br><span class=\"line\"><span class=\"comment\">//enemy_tank[0].live = 0;</span></span><br><span class=\"line\"><span class=\"comment\">//敌方坦克登场</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(enemy_tank[i].x, enemy_tank[i].y, <span class=\"number\">100</span> + i);</span><br><span class=\"line\">\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"敌方坦克的路由控制\"><a href=\"#敌方坦克的路由控制\" class=\"headerlink\" title=\"敌方坦克的路由控制\"></a>敌方坦克的路由控制</h4><p>首先我们设置敌方坦克会不断移动，那么我们只需要控制他的方向，让他的移动方向面向目标，如果有障碍物，可以通过炮击清除障碍物</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//防止坦克出生重叠</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (times &gt; <span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">1000</span> == <span class=\"number\">0</span> &amp;&amp; enemy_total &lt; enemy_num)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, <span class=\"number\">100</span> + enemy_total);</span><br><span class=\"line\">\t\tenemy_total++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (times&gt;<span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">200</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!enemy_tank[i].live)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//攻击我方老巢</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], <span class=\"number\">12</span>, <span class=\"number\">24</span>);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], my_tank.x, my_tank.y);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">tank_fire</span>(&amp;enemy_tank[i], &amp;enemy_bullet[i]);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//0.5s移动一次敌方坦克</span></span><br><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (times % <span class=\"number\">50</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"游戏结束场景的实现\"><a href=\"#游戏结束场景的实现\" class=\"headerlink\" title=\"游戏结束场景的实现\"></a>游戏结束场景的实现</h4><p>炮击函数中会返回一个游戏状态值，如果该状态值为真（1），则 game 函数就返回 0，如果敌方坦克全部歼灭，则返回 1，将该数值传入 gameover（）中，如果为 1 则显示胜利图像，如果为 0 则显示失败的图像，然后在 display 的循环中，如果为 1 则 stage+1，将该值传递给 game（）就可以进行下一关游戏</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"C-语言坦克大战（IKUN-版）\"><a href=\"#C-语言坦克大战（IKUN-版）\" class=\"headerlink\" title=\"C 语言坦克大战（IKUN 版）\"></a>C 语言坦克大战（IKUN 版）</h1><p><strong>前言：该坦克大战基于 90 经典坦克大战，对地图音乐等元素进行重新定制，实现成分十足的 IKUN 版坦克大战</strong></p>\n<p><strong>设计思路：把地图和坦克在地图上的位置都存储在一个二维数组里，坦克的移动，地图的破环以及碰撞检测都是通过修改或是检查二维数组的数据实现，以下是设计的过程</strong></p>\n<h2 id=\"游戏窗口的实现\"><a href=\"#游戏窗口的实现\" class=\"headerlink\" title=\"游戏窗口的实现\"></a>游戏窗口的实现</h2><p>通过 easyx 库中所提供的函数实现</p>\n<h3 id=\"初始化一个-650-650（单位：像素）大小的窗口\"><a href=\"#初始化一个-650-650（单位：像素）大小的窗口\" class=\"headerlink\" title=\"初始化一个 650* 650（单位：像素）大小的窗口\"></a>初始化一个 650* 650（单位：像素）大小的窗口</h3><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//初始化窗口</span></span><br><span class=\"line\">\t<span class=\"built_in\">initgraph</span>(<span class=\"number\">650</span>, <span class=\"number\">650</span>);</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"菜单功能\"><a href=\"#菜单功能\" class=\"headerlink\" title=\"菜单功能\"></a>菜单功能</h3><h4 id=\"菜单显示\"><a href=\"#菜单显示\" class=\"headerlink\" title=\"菜单显示\"></a>菜单显示</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//显示主菜单</span></span><br><span class=\"line\">IMAGE display_1_img;</span><br><span class=\"line\"><span class=\"built_in\">loadimage</span>(&amp;display_1_img, _T(<span class=\"string\">&quot;display_1.png&quot;</span>), <span class=\"number\">650</span>, <span class=\"number\">650</span>);</span><br><span class=\"line\"><span class=\"built_in\">putimage</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;display_1_img);</span><br><span class=\"line\"><span class=\"comment\">//help菜单图片</span></span><br><span class=\"line\">IMAGE help_img;<span class=\"comment\">//help菜单图片</span></span><br><span class=\"line\"><span class=\"built_in\">loadimage</span>(&amp;help_img, _T(<span class=\"string\">&quot;help.bmp&quot;</span>), <span class=\"number\">650</span>, <span class=\"number\">650</span>);<span class=\"comment\">//加载图片</span></span><br></pre></td></tr></table></figure>\n\n<p>主菜单我采用了直接制作一张完整的图片然后覆盖整个窗口</p>\n<p>可以采用 easyx 中自带的绘制图形或输出文字的函数，如果要改变菜单按钮等可以直接修改代码完成，如果用整图的话就需要重新制图。</p>\n<p>主菜单的帮助界面我采用直接显示一张完整的图，所以先提前加载一下图片</p>\n<h4 id=\"菜单按钮实现\"><a href=\"#菜单按钮实现\" class=\"headerlink\" title=\"菜单按钮实现\"></a>菜单按钮实现</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MOUSEMSG mouse; <span class=\"comment\">//储存鼠标信息变量</span></span><br></pre></td></tr></table></figure>\n<p>首先定义一个变量存储鼠标信息，通过获取到的鼠标信息在进行选择操作</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//int finish = 1;//用于结束主菜单循环</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//主菜单按钮功能实现</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"number\">1</span>) </span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\tmouse = <span class=\"built_in\">GetMouseMsg</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">switch</span> (mouse.uMsg)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//help功能显示</span></span><br><span class=\"line\">\t<span class=\"keyword\">case</span> WM_MOUSEMOVE:</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt;<span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">320</span> &amp;&amp; mouse.y &lt; <span class=\"number\">385</span>)</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;help_img);</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, &amp;display_1_img);</span><br><span class=\"line\">\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">case</span> WM_LBUTTONDOWN:</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt; <span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">155</span> &amp;&amp; mouse.y &lt; <span class=\"number\">225</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">setbkcolor</span>(BLACK);<span class=\"comment\">//设置背景色</span></span><br><span class=\"line\">\t\t\t<span class=\"built_in\">cleardevice</span>();</span><br><span class=\"line\">\t\t\t<span class=\"type\">int</span> stage = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"type\">int</span> result = <span class=\"built_in\">game</span>(stage);</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">gameover</span>(result);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">system</span>(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_ENTER))</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (result)</span><br><span class=\"line\">\t\t\t\t\tstage++;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\t\t\tfinish = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt; <span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">235</span> &amp;&amp; mouse.y &lt; <span class=\"number\">300</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">game</span>();</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (mouse.x &gt; <span class=\"number\">245</span> &amp;&amp; mouse.x &lt; <span class=\"number\">430</span> &amp;&amp; mouse.y&gt;<span class=\"number\">400</span> &amp;&amp; mouse.y &lt; <span class=\"number\">470</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">exit</span>(<span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br></pre></td></tr></table></figure>\n\n<p>这里先说明一下第一个 case 语句，<strong>WM_MOUSEMOVE</strong> 获取的是鼠标的移动信息，在鼠标移动的时候就进入该 case 语句，然后后面的 if 语句则进行判断，如果鼠标移动的区域在 help 框的范围那么就显示 help 图片，如果没有的话就显示主菜单的图片</p>\n<p>然后再说明一下第二个 case 语句， <strong>WM_LBUTTONDOWN</strong> 可以获取鼠标的左键点击信息，如果按下左键则进入该语句，同样也是通过 if 语句判断鼠标点击的位置执行不同的操作，首先说最后一个，当我们点击 exit 框的时候就直接执行 exit（0）终止程序</p>\n<p>然后说明一下第一个 if 语句，当我们点击 <strong>new game</strong> 时则直接进行游戏</p>\n<p>如果点击 <strong>continue</strong> 则会加载游戏存档，继续上一次的游戏，继续游戏和新游戏公用一个函数，通过传递不同的参数值，来选择进入 <strong>game()</strong> 的时候是直接初始化，还是使用存档中的内容进行初始化操作</p>\n<h2 id=\"游戏模块\"><a href=\"#游戏模块\" class=\"headerlink\" title=\"游戏模块\"></a>游戏模块</h2><h4 id=\"地图的加载以及显示\"><a href=\"#地图的加载以及显示\" class=\"headerlink\" title=\"地图的加载以及显示\"></a>地图的加载以及显示</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//首先在game（）函数实现的中定义一个全局二维数组以存储地图信息</span></span><br><span class=\"line\"><span class=\"type\">int</span> map[map_row][map_col];<span class=\"comment\">//map_row,map_col为地图的长和宽，也是地图数组行和列的大小（在gamesettings.h中定义）</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//然后是地图资源的加载，需要从文件中加载地图资源并存储到map数组中</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">loadmap</span><span class=\"params\">(<span class=\"type\">int</span> stage)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//地图文件流</span></span><br><span class=\"line\">\tifstream map_file;</span><br><span class=\"line\">\t<span class=\"comment\">//保存地图文件名</span></span><br><span class=\"line\">\twstring temp;</span><br><span class=\"line\">\ttemp = map_file_path;</span><br><span class=\"line\">\ttemp += map_file_name;</span><br><span class=\"line\">\t<span class=\"type\">int</span> text = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tmap_file.<span class=\"built_in\">open</span>(temp);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!map_file.<span class=\"built_in\">is_open</span>())</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\ttext = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tcout &lt;&lt; <span class=\"string\">&quot;打开地图失败！&quot;</span> &lt;&lt; endl;</span><br><span class=\"line\">\t\t<span class=\"comment\">//exit(1);</span></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//调整文件读取位置，到最大关卡数之后则从第一关开始</span></span><br><span class=\"line\">\tstage -= <span class=\"number\">1</span>;</span><br><span class=\"line\">\tstage = stage % max_stage;</span><br><span class=\"line\">\tmap_file.<span class=\"built_in\">seekg</span>(stage * map_row * map_col * <span class=\"number\">2</span>);</span><br><span class=\"line\">\t<span class=\"type\">int</span> num_temp;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> row = <span class=\"number\">0</span>;row &lt; map_row;row++)</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> col = <span class=\"number\">0</span>;col &lt; map_col;col++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tmap_file &gt;&gt; dec &gt;&gt; num_temp;</span><br><span class=\"line\">\t\t\tmap[row][col] = num_temp;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\tmap_file.<span class=\"built_in\">close</span>();</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//地图显示函数</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">Map</span><span class=\"params\">(<span class=\"type\">int</span> stage)</span> </span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> row, col;</span><br><span class=\"line\">\tIMAGE img_home, img_wall_1, img_wall_2;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_home, _T(<span class=\"string\">&quot;home_1.jpg&quot;</span>), <span class=\"number\">50</span>, <span class=\"number\">50</span>);<span class=\"comment\">// 老鹰</span></span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_wall_1, _T(<span class=\"string\">&quot;wall_1.jpg&quot;</span>), <span class=\"number\">25</span>, <span class=\"number\">25</span>);<span class=\"comment\">//不可消除的墙</span></span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_wall_2, _T(<span class=\"string\">&quot;wall_2.jpg&quot;</span>), <span class=\"number\">25</span>, <span class=\"number\">25</span>);<span class=\"comment\">//可消除的墙</span></span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (i = <span class=\"number\">0</span>; i &lt; <span class=\"number\">26</span>; i++) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (j = <span class=\"number\">0</span>; j &lt; <span class=\"number\">26</span>; j++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (map[i][j] == <span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">25</span> * j, <span class=\"number\">25</span> * i, &amp;img_wall_1);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (map[i][j] == <span class=\"number\">2</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">25</span> * j, <span class=\"number\">25</span> * i, &amp;img_wall_2);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (map[i][j] == <span class=\"number\">3</span>) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">putimage</span>(<span class=\"number\">25</span> * j, <span class=\"number\">25</span> * i, &amp;img_home);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\tmap[i][j] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t\tmap[i][j + <span class=\"number\">1</span>] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t\tmap[i + <span class=\"number\">1</span>][j] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t\tmap[i + <span class=\"number\">1</span>][j + <span class=\"number\">1</span>] = <span class=\"number\">4</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>game ()函数</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">game</span><span class=\"params\">(<span class=\"type\">int</span> stage)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"built_in\">setbkcolor</span>(BLACK);<span class=\"comment\">//设置背景色</span></span><br><span class=\"line\">\t<span class=\"built_in\">cleardevice</span>();</span><br><span class=\"line\">\t<span class=\"comment\">//背景音乐</span></span><br><span class=\"line\">\t<span class=\"built_in\">mciSendString</span>(_T(<span class=\"string\">&quot;play cxk_1.mp3 repeat&quot;</span>), <span class=\"literal\">NULL</span>, <span class=\"number\">0</span>, <span class=\"literal\">NULL</span>);</span><br><span class=\"line\">\t<span class=\"comment\">//初始化随机数种子</span></span><br><span class=\"line\">\t<span class=\"built_in\">srand</span>((<span class=\"type\">unsigned</span> <span class=\"type\">int</span>)<span class=\"built_in\">time</span>(<span class=\"literal\">NULL</span>));</span><br><span class=\"line\">\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//我方坦克</span></span><br><span class=\"line\">\tTank my_tank;</span><br><span class=\"line\">\t<span class=\"comment\">//我方坦克发射的子弹</span></span><br><span class=\"line\">\tBullet my_bullet;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克</span></span><br><span class=\"line\">\tTank enemy_tank[enemy_num];</span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克发射的子弹</span></span><br><span class=\"line\">\tBullet enemy_bullet[enemy_num];</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//加载地图</span></span><br><span class=\"line\">\t<span class=\"built_in\">loadmap</span>(stage);</span><br><span class=\"line\">\t<span class=\"built_in\">Map</span>(stage);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//记录当前的程序的休眠次数，每次10ms</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> times = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克存在数量</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> enemy_total = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//子弹目前不存在</span></span><br><span class=\"line\">\tmy_bullet.status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//测试</span></span><br><span class=\"line\">\t</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//加载坦克图片</span></span><br><span class=\"line\">\tIMAGE img_mytank[DIRECTIONCOUNT];</span><br><span class=\"line\">\tIMAGE img_enemytank[DIRECTIONCOUNT];</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[UP], mytank_filename[UP], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[DOWN], mytank_filename[DOWN], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[LEFT],mytank_filename[LEFT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_mytank[RIGHT], mytank_filename[RIGHT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[UP], enemytank_filename[UP], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[DOWN], enemytank_filename[DOWN], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[LEFT], enemytank_filename[LEFT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"built_in\">loadimage</span>(&amp;img_enemytank[RIGHT], enemytank_filename[RIGHT], <span class=\"number\">50</span>, <span class=\"number\">50</span>);</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t<span class=\"comment\">//初始化坦克</span></span><br><span class=\"line\">\tmy_tank.x = <span class=\"number\">8</span>;</span><br><span class=\"line\">\tmy_tank.y = <span class=\"number\">24</span>;</span><br><span class=\"line\">\tmy_tank.direction = UP;</span><br><span class=\"line\">\tmy_tank.live = <span class=\"number\">1</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"built_in\">set_map</span>(my_tank.x, my_tank.y, <span class=\"number\">200</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//设置敌方坦克出场位置</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tenemy_tank[i].x = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tenemy_tank[i].x = <span class=\"number\">12</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">2</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tenemy_tank[i].x = <span class=\"number\">24</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tenemy_tank[i].y = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tenemy_tank[i].live = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\tenemy_tank[i].direction = DOWN;</span><br><span class=\"line\">\t\tenemy_tank[i].Is_Mycamp = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);</span></span><br><span class=\"line\">\t\tenemy_bullet[i].status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">enemy_total = <span class=\"number\">3</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//enemy_tank[0].x = 4;</span></span><br><span class=\"line\">\t<span class=\"comment\">//enemy_tank[0].y = 0;</span></span><br><span class=\"line\">\t<span class=\"comment\">//enemy_tank[0].live = 0;</span></span><br><span class=\"line\">\t<span class=\"comment\">//敌方坦克登场</span></span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">set_map</span>(enemy_tank[i].x, enemy_tank[i].y, <span class=\"number\">100</span> + i);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//显示坦克\t\t</span></span><br><span class=\"line\">\t<span class=\"built_in\">putimage</span>(my_tank.x * <span class=\"number\">25</span>, my_tank.y * <span class=\"number\">25</span>, &amp;img_mytank[my_tank.direction]);</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//防止坦克出生重叠</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (times &gt; <span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">1000</span> == <span class=\"number\">0</span> &amp;&amp; enemy_total &lt; enemy_num)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">set_map</span>(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, <span class=\"number\">100</span> + enemy_total);</span><br><span class=\"line\">\t\t\t\tenemy_total++;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (times&gt;<span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">200</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (!enemy_tank[i].live)</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//攻击我方老巢</span></span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], <span class=\"number\">12</span>, <span class=\"number\">24</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], my_tank.x, my_tank.y);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">tank_fire</span>(&amp;enemy_tank[i], &amp;enemy_bullet[i]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">//0.5s移动一次敌方坦克</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (times % <span class=\"number\">50</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction]);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (times % <span class=\"number\">10</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_LEFT))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;my_tank, LEFT, &amp;img_mytank[LEFT]);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_UP))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (my_tank.direction == UP &amp;&amp; my_tank.y - <span class=\"number\">1</span> &gt;= <span class=\"number\">0</span> &amp;&amp; map[my_tank.y - <span class=\"number\">1</span>][my_tank.x] == <span class=\"number\">0</span> &amp;&amp; map[my_tank.y - <span class=\"number\">1</span>][my_tank.x + <span class=\"number\">1</span>] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, UP, &amp;img_mytank[my_tank.direction], <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (my_tank.direction != UP)</span><br><span class=\"line\">\t\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t\tmy_tank.direction = UP;</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, UP, &amp;img_mytank[my_tank.direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_DOWN))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (my_tank.direction == DOWN &amp;&amp; my_tank.y + <span class=\"number\">2</span> &lt;= <span class=\"number\">25</span> &amp;&amp; map[my_tank.y + <span class=\"number\">2</span>][my_tank.x] == <span class=\"number\">0</span> &amp;&amp; map[my_tank.y + <span class=\"number\">2</span>][my_tank.x + <span class=\"number\">1</span>] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, DOWN, &amp;img_mytank[my_tank.direction], <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (my_tank.direction != DOWN)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tmy_tank.direction = DOWN;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, DOWN, &amp;img_mytank[my_tank.direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_RIGHT))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (my_tank.direction == RIGHT &amp;&amp; my_tank.x + <span class=\"number\">2</span> &lt;= <span class=\"number\">25</span> &amp;&amp; map[my_tank.y][my_tank.x + <span class=\"number\">2</span>] == <span class=\"number\">0</span> &amp;&amp; map[my_tank.y + <span class=\"number\">1</span>][my_tank.x + <span class=\"number\">2</span>] == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, RIGHT, &amp;img_mytank[my_tank.direction], <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (my_tank.direction != RIGHT)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\tmy_tank.direction = RIGHT;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;my_tank, RIGHT, &amp;img_mytank[my_tank.direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//开火</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_J_Bullut))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">PlaySound</span>(_T(<span class=\"string\">&quot;paoji.wav&quot;</span>), <span class=\"literal\">NULL</span>, SND_FILENAME | SND_ASYNC);</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">tank_fire</span>(&amp;my_tank, &amp;my_bullet);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//暂停</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_P_Stop))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">while</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">system</span>(<span class=\"string\">&quot;pause&quot;</span>);</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_P_Stop))</span><br><span class=\"line\">\t\t\t\t\t\t<span class=\"keyword\">break</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">KEY_DOWN</span>(Key_ESC))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"built_in\">save</span>(enemy_tank, &amp;my_tank, enemy_total, times,map);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t\t<span class=\"built_in\">display_1</span>();</span><br><span class=\"line\">\t\t\t\t<span class=\"comment\">//break;</span></span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (my_bullet.status)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">bullet_action</span>(&amp;my_bullet, enemy_tank, my_tank.Is_Mycamp))</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (enemy_bullet[i].status)</span><br><span class=\"line\">\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (<span class=\"built_in\">bullet_action</span>(&amp;enemy_bullet[i], enemy_tank,<span class=\"number\">0</span>))</span><br><span class=\"line\">\t\t\t\t&#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//判断敌方坦克是否全部消灭</span></span><br><span class=\"line\">\t\t<span class=\"type\">int</span> isWin = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t\t\tisWin++;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (isWin == <span class=\"number\">10</span>)</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">Sleep</span>(<span class=\"number\">10</span>);</span><br><span class=\"line\">\t\ttimes++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"坦克移动功能的实现\"><a href=\"#坦克移动功能的实现\" class=\"headerlink\" title=\"坦克移动功能的实现\"></a>坦克移动功能的实现</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">do_tank_walk</span><span class=\"params\">(Tank* tank,DIRECTION dir,IMAGE *img,<span class=\"type\">int</span> step)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"type\">int</span> new_x = tank-&gt;x;</span><br><span class=\"line\">\t<span class=\"type\">int</span> new_y = tank-&gt;y;</span><br><span class=\"line\">\t<span class=\"type\">int</span> old_map = map[tank-&gt;y][tank-&gt;x];</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (step) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (dir == UP)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_y--;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == DOWN)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_y++;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == LEFT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_x--;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (dir == RIGHT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tnew_x++;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//清除地图数组上原坦克位置</span></span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(tank-&gt;x, tank-&gt;y, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//擦除原位置的坦克图像</span></span><br><span class=\"line\">\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t<span class=\"built_in\">solidrectangle</span>(tank-&gt;x * <span class=\"number\">25</span>, tank-&gt;y * <span class=\"number\">25</span>, tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">50</span>, tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">50</span>);</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (step)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//更新地图数组坦克位置</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(new_x, new_y, old_map);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">//更新坦克坐标</span></span><br><span class=\"line\">\t\ttank-&gt;x = new_x;</span><br><span class=\"line\">\t\ttank-&gt;y = new_y;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//调整方向应在外部实现，否则会传入键入前的坦克方向</span></span><br><span class=\"line\">\t<span class=\"comment\">//调整方向</span></span><br><span class=\"line\">\t<span class=\"comment\">//tank-&gt;direction = dir;</span></span><br><span class=\"line\">\t<span class=\"built_in\">putimage</span>(tank-&gt;x * <span class=\"number\">25</span>, tank-&gt;y * <span class=\"number\">25</span>, img);</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>坦克移动的实现还需要设置地图数据的函数，这个函数主要是简化代码，因为每个坦克都会占据 4 个地图单位所以每次移动都需要把重新设置地图数组上四个数据</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">set_map</span><span class=\"params\">(<span class=\"type\">int</span> x,<span class=\"type\">int</span> y,<span class=\"type\">int</span> val)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\tmap[y][x] = val;</span><br><span class=\"line\">\tmap[y][x+<span class=\"number\">1</span>] = val;</span><br><span class=\"line\">\tmap[y+<span class=\"number\">1</span>][x] = val;</span><br><span class=\"line\">\tmap[y+<span class=\"number\">1</span>][x+<span class=\"number\">1</span>] = val;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"坦克炮击功能\"><a href=\"#坦克炮击功能\" class=\"headerlink\" title=\"坦克炮击功能\"></a>坦克炮击功能</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"type\">void</span> <span class=\"title\">tank_fire</span><span class=\"params\">(Tank* tank, Bullet* bullet)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (!bullet-&gt;status)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//PlaySound(_T(&quot;paoji.wav&quot;), NULL, SND_FILENAME | SND_ASYNC);</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (tank-&gt;direction == UP)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> - <span class=\"number\">3</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tank-&gt;direction == LEFT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> - <span class=\"number\">3</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tank-&gt;direction == DOWN)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">50</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (tank-&gt;direction == RIGHT)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">//子弹绘图坐标修正</span></span><br><span class=\"line\">\t\t\tbullet-&gt;pos_x = tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">50</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;pos_y = tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">23</span>;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"comment\">//获取子弹方向</span></span><br><span class=\"line\">\t\tbullet-&gt;direction = tank-&gt;direction;</span><br><span class=\"line\">\t\t<span class=\"comment\">//改变子弹状态</span></span><br><span class=\"line\">\t\tbullet-&gt;status = !bullet-&gt;status;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"function\"><span class=\"type\">int</span> <span class=\"title\">bullet_action</span><span class=\"params\">(Bullet* bullet,Tank* enemy_tank,<span class=\"type\">int</span> Is_Mytank)</span></span></span><br><span class=\"line\"><span class=\"function\"></span>&#123;</span><br><span class=\"line\">\t<span class=\"comment\">//子弹在地图中二维数组的坐标</span></span><br><span class=\"line\">\t<span class=\"type\">int</span> x, y,x1,y1;</span><br><span class=\"line\">\tx = bullet-&gt;pos_x / <span class=\"number\">25</span>;</span><br><span class=\"line\">\ty = bullet-&gt;pos_y / <span class=\"number\">25</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//擦除上一次绘制的子弹</span></span><br><span class=\"line\">\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t<span class=\"built_in\">solidrectangle</span>(bullet-&gt;pos_x, bullet-&gt;pos_y, bullet-&gt;pos_x+<span class=\"number\">3</span>, bullet-&gt;pos_y+<span class=\"number\">3</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//根据方向计算子弹的坐标</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (bullet-&gt;direction == UP)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_y -= <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ty1 = y;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bullet-&gt;direction == DOWN)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_y += <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\ty1 = y;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bullet-&gt;direction == LEFT)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_x -= <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x;</span><br><span class=\"line\">\t\ty1 = y + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (bullet-&gt;direction == RIGHT)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;pos_x += <span class=\"number\">2</span>;</span><br><span class=\"line\">\t\tx1 = x;</span><br><span class=\"line\">\t\ty1 = y + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (bullet-&gt;pos_x &lt; <span class=\"number\">0</span> || bullet-&gt;pos_x&gt;<span class=\"number\">650</span> || bullet-&gt;pos_y &lt; <span class=\"number\">0</span> || bullet-&gt;pos_y&gt;<span class=\"number\">650</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">\t<span class=\"comment\">//碰撞检查</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y][x] == <span class=\"number\">4</span> || map[y1][y1] == <span class=\"number\">4</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">PlaySound</span>(_T(<span class=\"string\">&quot;boom.wav&quot;</span>), <span class=\"literal\">NULL</span>, SND_FILENAME | SND_ASYNC);</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//击中我方坦克</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y][x] == <span class=\"number\">200</span> || map[y1][x1] == <span class=\"number\">200</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//判断是否是敌方坦克发射的子弹</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span>(Is_Mytank==<span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"number\">1</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//击中敌方坦克</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> ((map[y][x] &gt;= <span class=\"number\">100</span> &amp;&amp; map[y][x] &lt;= <span class=\"number\">109</span>) || (map[y1][x1] &gt;= <span class=\"number\">100</span> &amp;&amp; map[y1][x1] &lt;= <span class=\"number\">109</span>))</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"comment\">//判断是否是我方发射的子弹</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (Is_Mytank == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tTank* tank = <span class=\"literal\">NULL</span>;</span><br><span class=\"line\">\t\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (map[y][x] &gt; <span class=\"number\">100</span> &amp;&amp; map[y][x] &lt;= <span class=\"number\">109</span>)</span><br><span class=\"line\">\t\t\t\ttank = enemy_tank + (map[y][x] - <span class=\"number\">100</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t\t\ttank = enemy_tank + (map[y1][x1] - <span class=\"number\">100</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t\ttank-&gt;live = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">set_map</span>(tank-&gt;x, tank-&gt;y, <span class=\"number\">0</span>);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">solidrectangle</span>(tank-&gt;x * <span class=\"number\">25</span>, tank-&gt;y * <span class=\"number\">25</span>, tank-&gt;x * <span class=\"number\">25</span> + <span class=\"number\">50</span>, tank-&gt;y * <span class=\"number\">25</span> + <span class=\"number\">50</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//子弹击中可消除的墙</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y][x] == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tmap[y][x] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t\t<span class=\"built_in\">solidrectangle</span>(x * <span class=\"number\">25</span>, y * <span class=\"number\">25</span>, x * <span class=\"number\">25</span> + <span class=\"number\">25</span>, y * <span class=\"number\">25</span> + <span class=\"number\">25</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span>(map[y][x]==<span class=\"number\">2</span>)<span class=\"comment\">//击中不可消除的墙</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"comment\">//子弹击中可消除的墙</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (map[y1][x1] == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tmap[y1][x1] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"built_in\">setfillcolor</span>(BLACK);</span><br><span class=\"line\">\t\t<span class=\"built_in\">solidrectangle</span>(x1 * <span class=\"number\">25</span>, y1 * <span class=\"number\">25</span>, x1 * <span class=\"number\">25</span> + <span class=\"number\">25</span>, y1 * <span class=\"number\">25</span> + <span class=\"number\">25</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (map[y1][x1] == <span class=\"number\">2</span>)<span class=\"comment\">//击中不可消除的墙</span></span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tbullet-&gt;status = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">//重新绘制子弹</span></span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (bullet-&gt;status)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">setfillcolor</span>(WHITE);</span><br><span class=\"line\">\t\t<span class=\"built_in\">solidrectangle</span>(bullet-&gt;pos_x, bullet-&gt;pos_y, bullet-&gt;pos_x + <span class=\"number\">3</span>, bullet-&gt;pos_y + <span class=\"number\">3</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"敌方坦克的实现\"><a href=\"#敌方坦克的实现\" class=\"headerlink\" title=\"敌方坦克的实现\"></a>敌方坦克的实现</h4><figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//设置敌方坦克出场位置</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_num;i++)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tenemy_tank[i].x = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">1</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tenemy_tank[i].x = <span class=\"number\">12</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t<span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (i % <span class=\"number\">3</span> == <span class=\"number\">2</span>)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\tenemy_tank[i].x = <span class=\"number\">24</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\tenemy_tank[i].y = <span class=\"number\">0</span>;</span><br><span class=\"line\">\tenemy_tank[i].live = <span class=\"number\">1</span>;</span><br><span class=\"line\">\tenemy_tank[i].direction = DOWN;</span><br><span class=\"line\">\tenemy_tank[i].Is_Mycamp = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t<span class=\"comment\">//set_map(enemy_tank[i].x, enemy_tank[i].y, 100 + i);</span></span><br><span class=\"line\">\tenemy_bullet[i].status = <span class=\"number\">0</span>;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">enemy_total = <span class=\"number\">3</span>;</span><br><span class=\"line\"><span class=\"comment\">//enemy_tank[0].x = 4;</span></span><br><span class=\"line\"><span class=\"comment\">//enemy_tank[0].y = 0;</span></span><br><span class=\"line\"><span class=\"comment\">//enemy_tank[0].live = 0;</span></span><br><span class=\"line\"><span class=\"comment\">//敌方坦克登场</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(enemy_tank[i].x, enemy_tank[i].y, <span class=\"number\">100</span> + i);</span><br><span class=\"line\">\t\t<span class=\"built_in\">do_tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction], <span class=\"number\">0</span>);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"敌方坦克的路由控制\"><a href=\"#敌方坦克的路由控制\" class=\"headerlink\" title=\"敌方坦克的路由控制\"></a>敌方坦克的路由控制</h4><p>首先我们设置敌方坦克会不断移动，那么我们只需要控制他的方向，让他的移动方向面向目标，如果有障碍物，可以通过炮击清除障碍物</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">//防止坦克出生重叠</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (map[enemy_tank[enemy_total].x][enemy_tank[enemy_total].y] == <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">if</span> (times &gt; <span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">1000</span> == <span class=\"number\">0</span> &amp;&amp; enemy_total &lt; enemy_num)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"built_in\">set_map</span>(enemy_tank[enemy_total].x, enemy_tank[enemy_total].y, <span class=\"number\">100</span> + enemy_total);</span><br><span class=\"line\">\t\tenemy_total++;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"keyword\">if</span> (times&gt;<span class=\"number\">0</span> &amp;&amp; times % <span class=\"number\">200</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (!enemy_tank[i].live)</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">continue</span>;</span><br><span class=\"line\">\t\t<span class=\"comment\">//攻击我方老巢</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (i % <span class=\"number\">2</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], <span class=\"number\">12</span>, <span class=\"number\">24</span>);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">else</span></span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\tDIRECTION d = <span class=\"built_in\">enemy_direction</span>(&amp;enemy_tank[i], my_tank.x, my_tank.y);</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], d, &amp;img_enemytank[d]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"built_in\">tank_fire</span>(&amp;enemy_tank[i], &amp;enemy_bullet[i]);</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">//0.5s移动一次敌方坦克</span></span><br><span class=\"line\"><span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (times % <span class=\"number\">50</span> == <span class=\"number\">0</span>)</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">\t<span class=\"keyword\">for</span> (<span class=\"type\">int</span> i = <span class=\"number\">0</span>;i &lt; enemy_total;i++)</span><br><span class=\"line\">\t&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">if</span> (enemy_tank[i].live)</span><br><span class=\"line\">\t\t&#123;</span><br><span class=\"line\">\t\t\t<span class=\"built_in\">tank_walk</span>(&amp;enemy_tank[i], enemy_tank[i].direction, &amp;img_enemytank[enemy_tank[i].direction]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"游戏结束场景的实现\"><a href=\"#游戏结束场景的实现\" class=\"headerlink\" title=\"游戏结束场景的实现\"></a>游戏结束场景的实现</h4><p>炮击函数中会返回一个游戏状态值，如果该状态值为真（1），则 game 函数就返回 0，如果敌方坦克全部歼灭，则返回 1，将该数值传入 gameover（）中，如果为 1 则显示胜利图像，如果为 0 则显示失败的图像，然后在 display 的循环中，如果为 1 则 stage+1，将该值传递给 game（）就可以进行下一关游戏</p>\n<figure class=\"highlight c++\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>"}],"PostAsset":[],"PostCategory":[{"post_id":"clgpfcfr20000dovt25jp38wi","category_id":"clgphtz8c0000zwvtbpihbnwz","_id":"clgphtz8d0001zwvt1b84aema"}],"PostTag":[{"post_id":"clgpfcfr20000dovt25jp38wi","tag_id":"clgpgbb8x0001dovt4l29e00n","_id":"clgpgbb8y0002dovt6d2aab8o"}],"Tag":[{"name":"hey","_id":"clgpgbb8x0001dovt4l29e00n"}]}}